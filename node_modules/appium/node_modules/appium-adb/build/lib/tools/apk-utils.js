"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.REMOTE_CACHE_ROOT = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _helpers = require("../helpers.js");

var _teen_process = require("teen_process");

var _logger = _interopRequireDefault(require("../logger.js"));

var _path = _interopRequireDefault(require("path"));

var _lodash = _interopRequireDefault(require("lodash"));

var _asyncbox = require("asyncbox");

var _appiumSupport = require("appium-support");

var _semver = _interopRequireDefault(require("semver"));

var _os = _interopRequireDefault(require("os"));

var _lruCache = _interopRequireDefault(require("lru-cache"));

let apkUtilsMethods = {};
const ACTIVITIES_TROUBLESHOOTING_LINK = 'https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/android/activity-startup.md';
apkUtilsMethods.APP_INSTALL_STATE = {
  UNKNOWN: 'unknown',
  NOT_INSTALLED: 'notInstalled',
  NEWER_VERSION_INSTALLED: 'newerVersionInstalled',
  SAME_VERSION_INSTALLED: 'sameVersionInstalled',
  OLDER_VERSION_INSTALLED: 'olderVersionInstalled'
};
const REMOTE_CACHE_ROOT = '/data/local/tmp/appium_cache';
exports.REMOTE_CACHE_ROOT = REMOTE_CACHE_ROOT;

apkUtilsMethods.isAppInstalled = function () {
  var _isAppInstalled = (0, _asyncToGenerator2.default)(function* (pkg) {
    _logger.default.debug(`Getting install status for ${pkg}`);

    const installedPattern = new RegExp(`^\\s*Package\\s+\\[${_lodash.default.escapeRegExp(pkg)}\\][^:]+:$`, 'm');

    try {
      const stdout = yield this.shell(['dumpsys', 'package', pkg]);
      const isInstalled = installedPattern.test(stdout);

      _logger.default.debug(`'${pkg}' is${!isInstalled ? ' not' : ''} installed`);

      return isInstalled;
    } catch (e) {
      throw new Error(`Error finding if '${pkg}' is installed. Original error: ${e.message}`);
    }
  });

  return function isAppInstalled(_x) {
    return _isAppInstalled.apply(this, arguments);
  };
}();

apkUtilsMethods.startUri = function () {
  var _startUri = (0, _asyncToGenerator2.default)(function* (uri, pkg) {
    if (!uri || !pkg) {
      throw new Error('URI and package arguments are required');
    }

    const args = ['am', 'start', '-W', '-a', 'android.intent.action.VIEW', '-d', uri.replace(/&/g, '\\&'), pkg];

    try {
      const res = yield this.shell(args);

      if (res.toLowerCase().includes('unable to resolve intent')) {
        throw new Error(res);
      }
    } catch (e) {
      throw new Error(`Error attempting to start URI. Original error: ${e}`);
    }
  });

  return function startUri(_x2, _x3) {
    return _startUri.apply(this, arguments);
  };
}();

apkUtilsMethods.startApp = function () {
  var _startApp = (0, _asyncToGenerator2.default)(function* (startAppOptions = {}) {
    if (!startAppOptions.activity || !startAppOptions.pkg) {
      throw new Error('activity and pkg are required to start an application');
    }

    startAppOptions = _lodash.default.clone(startAppOptions);
    startAppOptions.activity = startAppOptions.activity.replace('$', '\\$');

    _lodash.default.defaults(startAppOptions, {
      waitPkg: startAppOptions.pkg,
      waitActivity: false,
      retry: true,
      stopApp: true
    });

    startAppOptions.waitPkg = startAppOptions.waitPkg || startAppOptions.pkg;
    const apiLevel = yield this.getApiLevel();
    const cmd = (0, _helpers.buildStartCmd)(startAppOptions, apiLevel);

    try {
      const shellOpts = {};

      if (_lodash.default.isInteger(startAppOptions.waitDuration) && startAppOptions.waitDuration > 20000) {
        shellOpts.timeout = startAppOptions.waitDuration;
      }

      const stdout = yield this.shell(cmd, shellOpts);

      if (stdout.includes('Error: Activity class') && stdout.includes('does not exist')) {
        if (startAppOptions.retry && !startAppOptions.activity.startsWith('.')) {
          _logger.default.debug(`We tried to start an activity that doesn't exist, ` + `retrying with '.${startAppOptions.activity}' activity name`);

          startAppOptions.activity = `.${startAppOptions.activity}`;
          startAppOptions.retry = false;
          return yield this.startApp(startAppOptions);
        }

        throw new Error(`Activity name '${startAppOptions.activity}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
      } else if (stdout.includes('java.lang.SecurityException')) {
        throw new Error(`The permission to start '${startAppOptions.activity}' activity has been denied.` + `Make sure the activity/package names are correct.`);
      }

      if (startAppOptions.waitActivity) {
        yield this.waitForActivity(startAppOptions.waitPkg, startAppOptions.waitActivity, startAppOptions.waitDuration);
      }

      return stdout;
    } catch (e) {
      throw new Error(`Cannot start the '${startAppOptions.pkg}' application. ` + `Visit ${ACTIVITIES_TROUBLESHOOTING_LINK} for troubleshooting. ` + `Original error: ${e.message}`);
    }
  });

  return function startApp() {
    return _startApp.apply(this, arguments);
  };
}();

apkUtilsMethods.dumpWindows = function () {
  var _dumpWindows = (0, _asyncToGenerator2.default)(function* () {
    const apiLevel = yield this.getApiLevel();
    const dumpsysArg = apiLevel >= 29 ? 'displays' : 'windows';
    const cmd = ['dumpsys', 'window', dumpsysArg];
    return yield this.shell(cmd);
  });

  return function dumpWindows() {
    return _dumpWindows.apply(this, arguments);
  };
}();

apkUtilsMethods.getFocusedPackageAndActivity = function () {
  var _getFocusedPackageAndActivity = (0, _asyncToGenerator2.default)(function* () {
    _logger.default.debug('Getting focused package and activity');

    const nullFocusedAppRe = new RegExp(/^\s*mFocusedApp=null/, 'm');
    const focusedAppRe = new RegExp('^\\s*mFocusedApp.+Record\\{.*\\s([^\\s\\/\\}]+)' + '\\/([^\\s\\/\\}\\,]+)\\,?(\\s[^\\s\\/\\}]+)*\\}', 'm');
    const nullCurrentFocusRe = new RegExp(/^\s*mCurrentFocus=null/, 'm');
    const currentFocusAppRe = new RegExp('^\\s*mCurrentFocus.+\\{.+\\s([^\\s\\/]+)\\/([^\\s]+)\\b', 'm');

    try {
      const stdout = yield this.dumpWindows();
      var _arr = [focusedAppRe, currentFocusAppRe];

      for (var _i = 0; _i < _arr.length; _i++) {
        const pattern = _arr[_i];
        const match = pattern.exec(stdout);

        if (match) {
          return {
            appPackage: match[1].trim(),
            appActivity: match[2].trim()
          };
        }
      }

      var _arr2 = [nullFocusedAppRe, nullCurrentFocusRe];

      for (var _i2 = 0; _i2 < _arr2.length; _i2++) {
        const pattern = _arr2[_i2];

        if (pattern.exec(stdout)) {
          return {
            appPackage: null,
            appActivity: null
          };
        }
      }

      throw new Error('Could not parse activity from dumpsys');
    } catch (e) {
      throw new Error(`Could not get focusPackageAndActivity. Original error: ${e.message}`);
    }
  });

  return function getFocusedPackageAndActivity() {
    return _getFocusedPackageAndActivity.apply(this, arguments);
  };
}();

apkUtilsMethods.waitForActivityOrNot = function () {
  var _waitForActivityOrNot = (0, _asyncToGenerator2.default)(function* (pkg, activity, waitForStop, waitMs = 20000) {
    var _this = this;

    if (!pkg || !activity) {
      throw new Error('Package and activity required.');
    }

    _logger.default.debug(`Waiting up to ${waitMs}ms for activity matching pkg: '${pkg}' and ` + `activity: '${activity}' to${waitForStop ? ' not' : ''} be focused`);

    const splitNames = names => names.split(',').map(name => name.trim());

    const allPackages = splitNames(pkg);
    const allActivities = splitNames(activity);
    let possibleActivityNames = [];
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
      for (var _iterator = allActivities[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
        let oneActivity = _step.value;

        if (oneActivity.startsWith('.')) {
          var _iteratorNormalCompletion2 = true;
          var _didIteratorError2 = false;
          var _iteratorError2 = undefined;

          try {
            for (var _iterator2 = allPackages[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
              let currentPkg = _step2.value;
              possibleActivityNames.push(`${currentPkg}${oneActivity}`.replace(/\.+/g, '.'));
            }
          } catch (err) {
            _didIteratorError2 = true;
            _iteratorError2 = err;
          } finally {
            try {
              if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
                _iterator2.return();
              }
            } finally {
              if (_didIteratorError2) {
                throw _iteratorError2;
              }
            }
          }
        } else {
          possibleActivityNames.push(oneActivity);
          possibleActivityNames.push(`${pkg}.${oneActivity}`);
        }
      }
    } catch (err) {
      _didIteratorError = true;
      _iteratorError = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion && _iterator.return != null) {
          _iterator.return();
        }
      } finally {
        if (_didIteratorError) {
          throw _iteratorError;
        }
      }
    }

    _logger.default.debug(`Possible activities, to be checked: ${possibleActivityNames.map(name => `'${name}'`).join(', ')}`);

    let possibleActivityPatterns = possibleActivityNames.map(possibleActivityName => new RegExp(`^${possibleActivityName.replace(/\./g, '\\.').replace(/\*/g, '.*?').replace(/\$/g, '\\$')}$`));
    let retries = parseInt(waitMs / 750, 10) || 1;
    retries = isNaN(retries) ? 30 : retries;
    yield (0, _asyncbox.retryInterval)(retries, 750, (0, _asyncToGenerator2.default)(function* () {
      let _ref2 = yield _this.getFocusedPackageAndActivity(),
          appPackage = _ref2.appPackage,
          appActivity = _ref2.appActivity;

      if (appActivity && appPackage) {
        let fullyQualifiedActivity = appActivity.startsWith('.') ? `${appPackage}${appActivity}` : appActivity;

        _logger.default.debug(`Found package: '${appPackage}' and fully qualified activity name : '${fullyQualifiedActivity}'`);

        let foundAct = _lodash.default.includes(allPackages, appPackage) && _lodash.default.findIndex(possibleActivityPatterns, possiblePattern => possiblePattern.test(fullyQualifiedActivity)) !== -1;

        if (!waitForStop && foundAct || waitForStop && !foundAct) {
          return;
        }
      }

      _logger.default.debug('Incorrect package and activity. Retrying.');

      throw new Error(`${possibleActivityNames.map(name => `'${name}'`).join(' or ')} never ${waitForStop ? 'stopped' : 'started'}. ` + `Visit ${ACTIVITIES_TROUBLESHOOTING_LINK} for troubleshooting`);
    }));
  });

  return function waitForActivityOrNot(_x4, _x5, _x6) {
    return _waitForActivityOrNot.apply(this, arguments);
  };
}();

apkUtilsMethods.waitForActivity = function () {
  var _waitForActivity = (0, _asyncToGenerator2.default)(function* (pkg, act, waitMs = 20000) {
    yield this.waitForActivityOrNot(pkg, act, false, waitMs);
  });

  return function waitForActivity(_x7, _x8) {
    return _waitForActivity.apply(this, arguments);
  };
}();

apkUtilsMethods.waitForNotActivity = function () {
  var _waitForNotActivity = (0, _asyncToGenerator2.default)(function* (pkg, act, waitMs = 20000) {
    yield this.waitForActivityOrNot(pkg, act, true, waitMs);
  });

  return function waitForNotActivity(_x9, _x10) {
    return _waitForNotActivity.apply(this, arguments);
  };
}();

apkUtilsMethods.uninstallApk = function () {
  var _uninstallApk = (0, _asyncToGenerator2.default)(function* (pkg, options = {}) {
    _logger.default.debug(`Uninstalling ${pkg}`);

    if (!(yield this.isAppInstalled(pkg))) {
      _logger.default.info(`${pkg} was not uninstalled, because it was not present on the device`);

      return false;
    }

    const cmd = ['uninstall'];

    if (options.keepData) {
      cmd.push('-k');
    }

    cmd.push(pkg);
    let stdout;

    try {
      yield this.forceStop(pkg);
      stdout = (yield this.adbExec(cmd, {
        timeout: options.timeout
      })).trim();
    } catch (e) {
      throw new Error(`Unable to uninstall APK. Original error: ${e.message}`);
    }

    _logger.default.debug(`'adb ${cmd.join(' ')}' command output: ${stdout}`);

    if (stdout.includes('Success')) {
      _logger.default.info(`${pkg} was successfully uninstalled`);

      return true;
    }

    _logger.default.info(`${pkg} was not uninstalled`);

    return false;
  });

  return function uninstallApk(_x11) {
    return _uninstallApk.apply(this, arguments);
  };
}();

apkUtilsMethods.installFromDevicePath = function () {
  var _installFromDevicePath = (0, _asyncToGenerator2.default)(function* (apkPathOnDevice, opts = {}) {
    let stdout = yield this.shell(['pm', 'install', '-r', apkPathOnDevice], opts);

    if (stdout.indexOf('Failure') !== -1) {
      throw new Error(`Remote install failed: ${stdout}`);
    }
  });

  return function installFromDevicePath(_x12) {
    return _installFromDevicePath.apply(this, arguments);
  };
}();

apkUtilsMethods.cacheApk = function () {
  var _cacheApk = (0, _asyncToGenerator2.default)(function* (apkPath, options = {}) {
    const appHash = yield _appiumSupport.fs.hash(apkPath);

    const remotePath = _path.default.posix.join(REMOTE_CACHE_ROOT, `${appHash}.apk`);

    const remoteCachedFiles = [];

    try {
      const errorMarker = '_ERROR_';
      let lsOutput = null;

      if (this._areExtendedLsOptionsSupported === true || !_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
        lsOutput = yield this.shell([`ls -t -1 ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
      }

      if (!_lodash.default.isString(lsOutput) || lsOutput.includes(errorMarker) && !lsOutput.includes(REMOTE_CACHE_ROOT)) {
        if (!_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
          _logger.default.debug('The current Android API does not support extended ls options. ' + 'Defaulting to no-options call');
        }

        lsOutput = yield this.shell([`ls ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
        this._areExtendedLsOptionsSupported = false;
      } else {
        this._areExtendedLsOptionsSupported = true;
      }

      if (lsOutput.includes(errorMarker)) {
        throw new Error(lsOutput.substring(0, lsOutput.indexOf(errorMarker)));
      }

      remoteCachedFiles.push(...lsOutput.split('\n').map(x => x.trim()).filter(Boolean));
    } catch (e) {
      _logger.default.debug(`Got an error '${e.message.trim()}' while getting the list of files in the cache. ` + `Assuming the cache does not exist yet`);

      yield this.shell(['mkdir', '-p', REMOTE_CACHE_ROOT]);
    }

    _logger.default.debug(`The count of applications in the cache: ${remoteCachedFiles.length}`);

    const toHash = remotePath => _path.default.posix.parse(remotePath).name;

    if (remoteCachedFiles.find(x => toHash(x) === appHash)) {
      _logger.default.info(`The application at '${apkPath}' is already cached to '${remotePath}'`);
    } else {
      _logger.default.info(`Caching the application at '${apkPath}' to '${remotePath}'`);

      const started = process.hrtime();
      yield this.push(apkPath, remotePath, {
        timeout: options.timeout
      });

      const _process$hrtime = process.hrtime(started),
            _process$hrtime2 = (0, _slicedToArray2.default)(_process$hrtime, 2),
            seconds = _process$hrtime2[0],
            nanos = _process$hrtime2[1];

      const _ref3 = yield _appiumSupport.fs.stat(apkPath),
            size = _ref3.size;

      _logger.default.info(`The upload of '${_path.default.basename(apkPath)}' (${_appiumSupport.util.toReadableSizeString(size)}) ` + `took ${(seconds + nanos / 1e9).toFixed(3)}s`);
    }

    if (!this.remoteAppsCache) {
      this.remoteAppsCache = new _lruCache.default({
        max: this.remoteAppsCacheLimit
      });
    }

    _lodash.default.difference(this.remoteAppsCache.keys(), remoteCachedFiles.map(toHash)).forEach(hash => this.remoteAppsCache.del(hash));

    this.remoteAppsCache.set(appHash, remotePath);
    const entriesToCleanup = remoteCachedFiles.map(x => _path.default.posix.join(REMOTE_CACHE_ROOT, x)).filter(x => !this.remoteAppsCache.has(toHash(x))).slice(this.remoteAppsCacheLimit - this.remoteAppsCache.keys().length);

    if (!_lodash.default.isEmpty(entriesToCleanup)) {
      try {
        yield this.shell(['rm', '-f', ...entriesToCleanup]);

        _logger.default.debug(`Deleted ${entriesToCleanup.length} expired application cache entries`);
      } catch (e) {
        _logger.default.warn(`Cannot delete ${entriesToCleanup.length} expired application cache entries. ` + `Original error: ${e.message}`);
      }
    }

    return remotePath;
  });

  return function cacheApk(_x13) {
    return _cacheApk.apply(this, arguments);
  };
}();

apkUtilsMethods.install = function () {
  var _install = (0, _asyncToGenerator2.default)(function* (appPath, options = {}) {
    var _this2 = this;

    if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
      return yield this.installApks(appPath, options);
    }

    options = _lodash.default.cloneDeep(options);

    _lodash.default.defaults(options, {
      replace: true,
      timeout: this.adbExecTimeout === _helpers.DEFAULT_ADB_EXEC_TIMEOUT ? _helpers.APK_INSTALL_TIMEOUT : this.adbExecTimeout,
      timeoutCapName: 'androidInstallTimeout'
    });

    const installArgs = (0, _helpers.buildInstallArgs)((yield this.getApiLevel()), options);
    const installOpts = {
      timeout: options.timeout,
      timeoutCapName: options.timeoutCapName
    };

    let performAppInstall = function () {
      var _ref4 = (0, _asyncToGenerator2.default)(function* () {
        return yield _this2.adbExec(['install', ...installArgs, appPath], installOpts);
      });

      return function performAppInstall() {
        return _ref4.apply(this, arguments);
      };
    }();

    if (this.remoteAppsCacheLimit > 0) {
      const cachedRemotePath = yield this.cacheApk(appPath, {
        timeout: options.timeout
      });

      performAppInstall = function () {
        var _ref5 = (0, _asyncToGenerator2.default)(function* () {
          return yield _this2.shell(['pm', 'install', ...installArgs, cachedRemotePath], installOpts);
        });

        return function performAppInstall() {
          return _ref5.apply(this, arguments);
        };
      }();
    }

    try {
      const started = process.hrtime();
      const output = yield performAppInstall();

      const _process$hrtime3 = process.hrtime(started),
            _process$hrtime4 = (0, _slicedToArray2.default)(_process$hrtime3, 2),
            seconds = _process$hrtime4[0],
            nanos = _process$hrtime4[1];

      _logger.default.info(`The installation of '${_path.default.basename(appPath)}' took ${(seconds + nanos / 1e9).toFixed(3)}s`);

      const truncatedOutput = !_lodash.default.isString(output) || output.length <= 300 ? output : `${output.substr(0, 150)}...${output.substr(output.length - 150)}`;

      _logger.default.debug(`Install command stdout: ${truncatedOutput}`);

      if (/\[INSTALL[A-Z_]+FAILED[A-Z_]+\]/.test(output)) {
        throw new Error(output);
      }
    } catch (err) {
      if (!err.message.includes('INSTALL_FAILED_ALREADY_EXISTS')) {
        throw err;
      }

      _logger.default.debug(`Application '${appPath}' already installed. Continuing.`);
    }
  });

  return function install(_x14) {
    return _install.apply(this, arguments);
  };
}();

apkUtilsMethods.getApplicationInstallState = function () {
  var _getApplicationInstallState = (0, _asyncToGenerator2.default)(function* (appPath, pkg = null) {
    let apkInfo = null;

    if (!pkg) {
      apkInfo = yield this.getApkInfo(appPath);
      pkg = apkInfo.name;
    }

    if (!pkg) {
      _logger.default.warn(`Cannot read the package name of '${appPath}'`);

      return this.APP_INSTALL_STATE.UNKNOWN;
    }

    if (!(yield this.isAppInstalled(pkg))) {
      _logger.default.debug(`App '${appPath}' is not installed`);

      return this.APP_INSTALL_STATE.NOT_INSTALLED;
    }

    const _ref6 = yield this.getPackageInfo(pkg),
          pkgVersionCode = _ref6.versionCode,
          pkgVersionNameStr = _ref6.versionName;

    const pkgVersionName = _semver.default.valid(_semver.default.coerce(pkgVersionNameStr));

    if (!apkInfo) {
      apkInfo = yield this.getApkInfo(appPath);
    }

    const _apkInfo = apkInfo,
          apkVersionCode = _apkInfo.versionCode,
          apkVersionNameStr = _apkInfo.versionName;

    const apkVersionName = _semver.default.valid(_semver.default.coerce(apkVersionNameStr));

    if (!_lodash.default.isInteger(apkVersionCode) || !_lodash.default.isInteger(pkgVersionCode)) {
      _logger.default.warn(`Cannot read version codes of '${appPath}' and/or '${pkg}'`);

      if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
        _logger.default.warn(`Cannot read version names of '${appPath}' and/or '${pkg}'`);

        return this.APP_INSTALL_STATE.UNKNOWN;
      }
    }

    if (_lodash.default.isInteger(apkVersionCode) && _lodash.default.isInteger(pkgVersionCode)) {
      if (pkgVersionCode > apkVersionCode) {
        _logger.default.debug(`The version code of the installed '${pkg}' is greater than the application version code (${pkgVersionCode} > ${apkVersionCode})`);

        return this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED;
      }

      if (pkgVersionCode === apkVersionCode) {
        if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
          _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);

          return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
        }

        if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
          _logger.default.debug(`The version name of the installed '${pkg}' is equal to application version name (${pkgVersionCode} === ${apkVersionCode})`);

          return this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
        }
      }
    } else if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
      _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);

      return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
    }

    _logger.default.debug(`The installed '${pkg}' package is older than '${appPath}' (${pkgVersionCode} < ${apkVersionCode} or '${pkgVersionName}' < '${apkVersionName}')'`);

    return this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED;
  });

  return function getApplicationInstallState(_x15) {
    return _getApplicationInstallState.apply(this, arguments);
  };
}();

apkUtilsMethods.installOrUpgrade = function () {
  var _installOrUpgrade = (0, _asyncToGenerator2.default)(function* (appPath, pkg = null, options = {}) {
    if (!pkg) {
      const apkInfo = yield this.getApkInfo(appPath);
      pkg = apkInfo.name;
    }

    const appState = yield this.getApplicationInstallState(appPath, pkg);

    switch (appState) {
      case this.APP_INSTALL_STATE.NOT_INSTALLED:
        _logger.default.debug(`Installing '${appPath}'`);

        yield this.install(appPath, Object.assign({}, options, {
          replace: false
        }));
        return;

      case this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED:
      case this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED:
        _logger.default.debug(`There is no need to install/upgrade '${appPath}'`);

        return;

      case this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED:
        _logger.default.debug(`Executing upgrade of '${appPath}'`);

        break;

      default:
        _logger.default.debug(`The current install state of '${appPath}' is unknown. Installing anyway`);

        break;
    }

    try {
      yield this.install(appPath, Object.assign({}, options, {
        replace: true
      }));
    } catch (err) {
      _logger.default.warn(`Cannot upgrade '${pkg}' because of '${err.message}'. Trying full reinstall`);

      if (!(yield this.uninstallApk(pkg))) {
        throw new Error(`'${pkg}' package cannot be uninstalled`);
      }

      yield this.install(appPath, Object.assign({}, options, {
        replace: false
      }));
    }
  });

  return function installOrUpgrade(_x16) {
    return _installOrUpgrade.apply(this, arguments);
  };
}();

apkUtilsMethods.extractStringsFromApk = function () {
  var _extractStringsFromApk = (0, _asyncToGenerator2.default)(function* (appPath, language, out) {
    _logger.default.debug(`Extracting strings from for language: ${language || 'default'}`);

    if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
      appPath = yield this.extractLanguageApk(appPath, language);
    }

    yield this.initAapt();
    let rawAaptOutput;

    try {
      const _ref7 = yield (0, _teen_process.exec)(this.binaries.aapt, ['d', '--values', 'resources', appPath]),
            stdout = _ref7.stdout;

      rawAaptOutput = stdout;
    } catch (e) {
      throw new Error(`Cannot extract resources from '${appPath}'. Original error: ${e.message}`);
    }

    const defaultConfigMarker = '(default)';
    let configMarker = language || defaultConfigMarker;

    if (configMarker.includes('-') && !configMarker.includes('-r')) {
      configMarker = configMarker.replace('-', '-r');
    }

    if (configMarker.toLowerCase().startsWith('en')) {
      const _ref8 = yield (0, _teen_process.exec)(this.binaries.aapt, ['d', 'configurations', appPath]),
            stdout = _ref8.stdout;

      const configs = stdout.split(_os.default.EOL);

      if (!configs.includes(configMarker)) {
        _logger.default.debug(`There is no '${configMarker}' configuration. ` + `Replacing it with '${defaultConfigMarker}'`);

        configMarker = defaultConfigMarker;
      }
    }

    const apkStrings = {};
    let isInConfig = false;
    let currentResourceId = null;
    let isInPluralGroup = false;

    const startsWithAny = (s, arr) => arr.reduce((acc, x) => acc || s.startsWith(x), false);

    const normalizeStringMatch = s => s.replace(/"$/, '').replace(/^"/, '').replace(/\\"/g, '"');

    var _iteratorNormalCompletion3 = true;
    var _didIteratorError3 = false;
    var _iteratorError3 = undefined;

    try {
      for (var _iterator3 = rawAaptOutput.split(_os.default.EOL)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
        const line = _step3.value;
        const trimmedLine = line.trim();

        if (_lodash.default.isEmpty(trimmedLine)) {
          continue;
        }

        if (startsWithAny(trimmedLine, ['config', 'type', 'spec', 'Package'])) {
          isInConfig = trimmedLine.startsWith(`config ${configMarker}:`);
          currentResourceId = null;
          isInPluralGroup = false;
          continue;
        }

        if (!isInConfig) {
          continue;
        }

        if (trimmedLine.startsWith('resource')) {
          isInPluralGroup = false;
          currentResourceId = null;

          if (trimmedLine.includes(':string/')) {
            const match = /:string\/(\S+):/.exec(trimmedLine);

            if (match) {
              currentResourceId = match[1];
            }
          } else if (trimmedLine.includes(':plurals/')) {
            const match = /:plurals\/(\S+):/.exec(trimmedLine);

            if (match) {
              currentResourceId = match[1];
              isInPluralGroup = true;
            }
          }

          continue;
        }

        if (currentResourceId && trimmedLine.startsWith('(string')) {
          const match = /"[^"\\]*(?:\\.[^"\\]*)*"/.exec(trimmedLine);

          if (match) {
            apkStrings[currentResourceId] = normalizeStringMatch(match[0]);
          }

          currentResourceId = null;
          continue;
        }

        if (currentResourceId && isInPluralGroup && trimmedLine.includes(': (string')) {
          const match = /"[^"\\]*(?:\\.[^"\\]*)*"/.exec(trimmedLine);

          if (match) {
            apkStrings[currentResourceId] = [...(apkStrings[currentResourceId] || []), normalizeStringMatch(match[0])];
          }

          continue;
        }
      }
    } catch (err) {
      _didIteratorError3 = true;
      _iteratorError3 = err;
    } finally {
      try {
        if (!_iteratorNormalCompletion3 && _iterator3.return != null) {
          _iterator3.return();
        }
      } finally {
        if (_didIteratorError3) {
          throw _iteratorError3;
        }
      }
    }

    if (_lodash.default.isEmpty(apkStrings)) {
      _logger.default.warn(`No strings have been found in '${appPath}' resources ` + `for '${configMarker}' configuration`);
    } else {
      _logger.default.info(`Successfully extracted ${_lodash.default.keys(apkStrings).length} strings from '${appPath}' resources ` + `for '${configMarker}' configuration`);
    }

    const localPath = _path.default.resolve(out, 'strings.json');

    yield (0, _appiumSupport.mkdirp)(out);
    yield _appiumSupport.fs.writeFile(localPath, JSON.stringify(apkStrings, null, 2), 'utf-8');
    return {
      apkStrings,
      localPath
    };
  });

  return function extractStringsFromApk(_x17, _x18, _x19) {
    return _extractStringsFromApk.apply(this, arguments);
  };
}();

apkUtilsMethods.getDeviceLanguage = function () {
  var _getDeviceLanguage = (0, _asyncToGenerator2.default)(function* () {
    let language;

    if ((yield this.getApiLevel()) < 23) {
      language = yield this.getDeviceSysLanguage();

      if (!language) {
        language = yield this.getDeviceProductLanguage();
      }
    } else {
      language = (yield this.getDeviceLocale()).split('-')[0];
    }

    return language;
  });

  return function getDeviceLanguage() {
    return _getDeviceLanguage.apply(this, arguments);
  };
}();

apkUtilsMethods.getDeviceCountry = function () {
  var _getDeviceCountry = (0, _asyncToGenerator2.default)(function* () {
    let country = yield this.getDeviceSysCountry();

    if (!country) {
      country = yield this.getDeviceProductCountry();
    }

    return country;
  });

  return function getDeviceCountry() {
    return _getDeviceCountry.apply(this, arguments);
  };
}();

apkUtilsMethods.getDeviceLocale = function () {
  var _getDeviceLocale = (0, _asyncToGenerator2.default)(function* () {
    let locale = yield this.getDeviceSysLocale();

    if (!locale) {
      locale = yield this.getDeviceProductLocale();
    }

    return locale;
  });

  return function getDeviceLocale() {
    return _getDeviceLocale.apply(this, arguments);
  };
}();

apkUtilsMethods.setDeviceLocale = function () {
  var _setDeviceLocale = (0, _asyncToGenerator2.default)(function* (locale) {
    const validateLocale = new RegExp(/[a-zA-Z]+-[a-zA-Z0-9]+/);

    if (!validateLocale.test(locale)) {
      _logger.default.warn(`setDeviceLocale requires the following format: en-US or ja-JP`);

      return;
    }

    let split_locale = locale.split('-');
    yield this.setDeviceLanguageCountry(split_locale[0], split_locale[1]);
  });

  return function setDeviceLocale(_x20) {
    return _setDeviceLocale.apply(this, arguments);
  };
}();

apkUtilsMethods.ensureCurrentLocale = function () {
  var _ensureCurrentLocale = (0, _asyncToGenerator2.default)(function* (language, country, script = null) {
    var _this3 = this;

    const hasLanguage = _lodash.default.isString(language);

    const hasCountry = _lodash.default.isString(country);

    if (!hasLanguage && !hasCountry) {
      _logger.default.warn('ensureCurrentLocale requires language or country');

      return false;
    }

    language = (language || '').toLowerCase();
    country = (country || '').toLowerCase();
    const apiLevel = yield this.getApiLevel();
    return yield (0, _asyncbox.retryInterval)(5, 1000, (0, _asyncToGenerator2.default)(function* () {
      try {
        if (apiLevel < 23) {
          let curLanguage, curCountry;

          if (hasLanguage) {
            curLanguage = (yield _this3.getDeviceLanguage()).toLowerCase();

            if (!hasCountry && language === curLanguage) {
              return true;
            }
          }

          if (hasCountry) {
            curCountry = (yield _this3.getDeviceCountry()).toLowerCase();

            if (!hasLanguage && country === curCountry) {
              return true;
            }
          }

          if (language === curLanguage && country === curCountry) {
            return true;
          }
        } else {
          const curLocale = (yield _this3.getDeviceLocale()).toLowerCase();
          const localeCode = script ? `${language}-${script.toLowerCase()}-${country}` : `${language}-${country}`;

          if (localeCode === curLocale) {
            _logger.default.debug(`Requested locale is equal to current locale: '${curLocale}'`);

            return true;
          }
        }

        return false;
      } catch (err) {
        _logger.default.error(`Unable to check device localization: ${err.message}`);

        _logger.default.debug('Restarting ADB and retrying...');

        yield _this3.restartAdb();
        throw err;
      }
    }));
  });

  return function ensureCurrentLocale(_x21, _x22) {
    return _ensureCurrentLocale.apply(this, arguments);
  };
}();

apkUtilsMethods.setDeviceLanguageCountry = function () {
  var _setDeviceLanguageCountry = (0, _asyncToGenerator2.default)(function* (language, country, script = null) {
    let hasLanguage = language && _lodash.default.isString(language);

    let hasCountry = country && _lodash.default.isString(country);

    if (!hasLanguage || !hasCountry) {
      _logger.default.warn(`setDeviceLanguageCountry requires language and country at least`);

      _logger.default.warn(`Got language: '${language}' and country: '${country}'`);

      return;
    }

    let apiLevel = yield this.getApiLevel();
    language = (language || '').toLowerCase();
    country = (country || '').toUpperCase();

    if (apiLevel < 23) {
      let curLanguage = (yield this.getDeviceLanguage()).toLowerCase();
      let curCountry = (yield this.getDeviceCountry()).toUpperCase();

      if (language !== curLanguage || country !== curCountry) {
        yield this.setDeviceSysLocaleViaSettingApp(language, country);
      }
    } else {
      let curLocale = yield this.getDeviceLocale();
      const localeCode = script ? `${language}-${script}-${country}` : `${language}-${country}`;

      _logger.default.debug(`Current locale: '${curLocale}'; requested locale: '${localeCode}'`);

      if (localeCode.toLowerCase() !== curLocale.toLowerCase()) {
        yield this.setDeviceSysLocaleViaSettingApp(language, country, script);
      }
    }
  });

  return function setDeviceLanguageCountry(_x23, _x24) {
    return _setDeviceLanguageCountry.apply(this, arguments);
  };
}();

apkUtilsMethods.getApkInfo = function () {
  var _getApkInfo = (0, _asyncToGenerator2.default)(function* (appPath) {
    if (!(yield _appiumSupport.fs.exists(appPath))) {
      throw new Error(`The file at path ${appPath} does not exist or is not accessible`);
    }

    if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
      appPath = yield this.extractBaseApk(appPath);
    }

    yield this.initAapt();

    try {
      const _ref10 = yield (0, _teen_process.exec)(this.binaries.aapt, ['d', 'badging', appPath]),
            stdout = _ref10.stdout;

      const matches = new RegExp(/package: name='([^']+)' versionCode='(\d+)' versionName='([^']+)'/).exec(stdout);

      if (matches) {
        return {
          name: matches[1],
          versionCode: parseInt(matches[2], 10),
          versionName: matches[3]
        };
      }
    } catch (err) {
      _logger.default.warn(`Error "${err.message}" while getting badging info`);
    }

    return {};
  });

  return function getApkInfo(_x25) {
    return _getApkInfo.apply(this, arguments);
  };
}();

apkUtilsMethods.getPackageInfo = function () {
  var _getPackageInfo = (0, _asyncToGenerator2.default)(function* (pkg) {
    _logger.default.debug(`Getting package info for '${pkg}'`);

    let result = {
      name: pkg
    };

    try {
      const stdout = yield this.shell(['dumpsys', 'package', pkg]);
      const versionNameMatch = new RegExp(/versionName=([\d+.]+)/).exec(stdout);

      if (versionNameMatch) {
        result.versionName = versionNameMatch[1];
      }

      const versionCodeMatch = new RegExp(/versionCode=(\d+)/).exec(stdout);

      if (versionCodeMatch) {
        result.versionCode = parseInt(versionCodeMatch[1], 10);
      }

      return result;
    } catch (err) {
      _logger.default.warn(`Error '${err.message}' while dumping package info`);
    }

    return result;
  });

  return function getPackageInfo(_x26) {
    return _getPackageInfo.apply(this, arguments);
  };
}();

apkUtilsMethods.pullApk = function () {
  var _pullApk = (0, _asyncToGenerator2.default)(function* (pkg, tmpDir) {
    const pkgPath = (yield this.adbExec(['shell', 'pm', 'path', pkg])).replace('package:', '');

    const tmpApp = _path.default.resolve(tmpDir, `${pkg}.apk`);

    yield this.pull(pkgPath, tmpApp);

    _logger.default.debug(`Pulled app for package '${pkg}' to '${tmpApp}'`);

    return tmpApp;
  });

  return function pullApk(_x27, _x28) {
    return _pullApk.apply(this, arguments);
  };
}();

var _default = apkUtilsMethods;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi90b29scy9hcGstdXRpbHMuanMiXSwibmFtZXMiOlsiYXBrVXRpbHNNZXRob2RzIiwiQUNUSVZJVElFU19UUk9VQkxFU0hPT1RJTkdfTElOSyIsIkFQUF9JTlNUQUxMX1NUQVRFIiwiVU5LTk9XTiIsIk5PVF9JTlNUQUxMRUQiLCJORVdFUl9WRVJTSU9OX0lOU1RBTExFRCIsIlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQiLCJPTERFUl9WRVJTSU9OX0lOU1RBTExFRCIsIlJFTU9URV9DQUNIRV9ST09UIiwiaXNBcHBJbnN0YWxsZWQiLCJwa2ciLCJsb2ciLCJkZWJ1ZyIsImluc3RhbGxlZFBhdHRlcm4iLCJSZWdFeHAiLCJfIiwiZXNjYXBlUmVnRXhwIiwic3Rkb3V0Iiwic2hlbGwiLCJpc0luc3RhbGxlZCIsInRlc3QiLCJlIiwiRXJyb3IiLCJtZXNzYWdlIiwic3RhcnRVcmkiLCJ1cmkiLCJhcmdzIiwicmVwbGFjZSIsInJlcyIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJzdGFydEFwcCIsInN0YXJ0QXBwT3B0aW9ucyIsImFjdGl2aXR5IiwiY2xvbmUiLCJkZWZhdWx0cyIsIndhaXRQa2ciLCJ3YWl0QWN0aXZpdHkiLCJyZXRyeSIsInN0b3BBcHAiLCJhcGlMZXZlbCIsImdldEFwaUxldmVsIiwiY21kIiwic2hlbGxPcHRzIiwiaXNJbnRlZ2VyIiwid2FpdER1cmF0aW9uIiwidGltZW91dCIsInN0YXJ0c1dpdGgiLCJ3YWl0Rm9yQWN0aXZpdHkiLCJkdW1wV2luZG93cyIsImR1bXBzeXNBcmciLCJnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5IiwibnVsbEZvY3VzZWRBcHBSZSIsImZvY3VzZWRBcHBSZSIsIm51bGxDdXJyZW50Rm9jdXNSZSIsImN1cnJlbnRGb2N1c0FwcFJlIiwicGF0dGVybiIsIm1hdGNoIiwiZXhlYyIsImFwcFBhY2thZ2UiLCJ0cmltIiwiYXBwQWN0aXZpdHkiLCJ3YWl0Rm9yQWN0aXZpdHlPck5vdCIsIndhaXRGb3JTdG9wIiwid2FpdE1zIiwic3BsaXROYW1lcyIsIm5hbWVzIiwic3BsaXQiLCJtYXAiLCJuYW1lIiwiYWxsUGFja2FnZXMiLCJhbGxBY3Rpdml0aWVzIiwicG9zc2libGVBY3Rpdml0eU5hbWVzIiwib25lQWN0aXZpdHkiLCJjdXJyZW50UGtnIiwicHVzaCIsImpvaW4iLCJwb3NzaWJsZUFjdGl2aXR5UGF0dGVybnMiLCJwb3NzaWJsZUFjdGl2aXR5TmFtZSIsInJldHJpZXMiLCJwYXJzZUludCIsImlzTmFOIiwiZnVsbHlRdWFsaWZpZWRBY3Rpdml0eSIsImZvdW5kQWN0IiwiZmluZEluZGV4IiwicG9zc2libGVQYXR0ZXJuIiwiYWN0Iiwid2FpdEZvck5vdEFjdGl2aXR5IiwidW5pbnN0YWxsQXBrIiwib3B0aW9ucyIsImluZm8iLCJrZWVwRGF0YSIsImZvcmNlU3RvcCIsImFkYkV4ZWMiLCJpbnN0YWxsRnJvbURldmljZVBhdGgiLCJhcGtQYXRoT25EZXZpY2UiLCJvcHRzIiwiaW5kZXhPZiIsImNhY2hlQXBrIiwiYXBrUGF0aCIsImFwcEhhc2giLCJmcyIsImhhc2giLCJyZW1vdGVQYXRoIiwicGF0aCIsInBvc2l4IiwicmVtb3RlQ2FjaGVkRmlsZXMiLCJlcnJvck1hcmtlciIsImxzT3V0cHV0IiwiX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkIiwiaXNCb29sZWFuIiwiaXNTdHJpbmciLCJzdWJzdHJpbmciLCJ4IiwiZmlsdGVyIiwiQm9vbGVhbiIsImxlbmd0aCIsInRvSGFzaCIsInBhcnNlIiwiZmluZCIsInN0YXJ0ZWQiLCJwcm9jZXNzIiwiaHJ0aW1lIiwic2Vjb25kcyIsIm5hbm9zIiwic3RhdCIsInNpemUiLCJiYXNlbmFtZSIsInV0aWwiLCJ0b1JlYWRhYmxlU2l6ZVN0cmluZyIsInRvRml4ZWQiLCJyZW1vdGVBcHBzQ2FjaGUiLCJMUlUiLCJtYXgiLCJyZW1vdGVBcHBzQ2FjaGVMaW1pdCIsImRpZmZlcmVuY2UiLCJrZXlzIiwiZm9yRWFjaCIsImRlbCIsInNldCIsImVudHJpZXNUb0NsZWFudXAiLCJoYXMiLCJzbGljZSIsImlzRW1wdHkiLCJ3YXJuIiwiaW5zdGFsbCIsImFwcFBhdGgiLCJlbmRzV2l0aCIsIkFQS1NfRVhURU5TSU9OIiwiaW5zdGFsbEFwa3MiLCJjbG9uZURlZXAiLCJhZGJFeGVjVGltZW91dCIsIkRFRkFVTFRfQURCX0VYRUNfVElNRU9VVCIsIkFQS19JTlNUQUxMX1RJTUVPVVQiLCJ0aW1lb3V0Q2FwTmFtZSIsImluc3RhbGxBcmdzIiwiaW5zdGFsbE9wdHMiLCJwZXJmb3JtQXBwSW5zdGFsbCIsImNhY2hlZFJlbW90ZVBhdGgiLCJvdXRwdXQiLCJ0cnVuY2F0ZWRPdXRwdXQiLCJzdWJzdHIiLCJlcnIiLCJnZXRBcHBsaWNhdGlvbkluc3RhbGxTdGF0ZSIsImFwa0luZm8iLCJnZXRBcGtJbmZvIiwiZ2V0UGFja2FnZUluZm8iLCJwa2dWZXJzaW9uQ29kZSIsInZlcnNpb25Db2RlIiwicGtnVmVyc2lvbk5hbWVTdHIiLCJ2ZXJzaW9uTmFtZSIsInBrZ1ZlcnNpb25OYW1lIiwic2VtdmVyIiwidmFsaWQiLCJjb2VyY2UiLCJhcGtWZXJzaW9uQ29kZSIsImFwa1ZlcnNpb25OYW1lU3RyIiwiYXBrVmVyc2lvbk5hbWUiLCJzYXRpc2ZpZXMiLCJpbnN0YWxsT3JVcGdyYWRlIiwiYXBwU3RhdGUiLCJPYmplY3QiLCJhc3NpZ24iLCJleHRyYWN0U3RyaW5nc0Zyb21BcGsiLCJsYW5ndWFnZSIsIm91dCIsImV4dHJhY3RMYW5ndWFnZUFwayIsImluaXRBYXB0IiwicmF3QWFwdE91dHB1dCIsImJpbmFyaWVzIiwiYWFwdCIsImRlZmF1bHRDb25maWdNYXJrZXIiLCJjb25maWdNYXJrZXIiLCJjb25maWdzIiwib3MiLCJFT0wiLCJhcGtTdHJpbmdzIiwiaXNJbkNvbmZpZyIsImN1cnJlbnRSZXNvdXJjZUlkIiwiaXNJblBsdXJhbEdyb3VwIiwic3RhcnRzV2l0aEFueSIsInMiLCJhcnIiLCJyZWR1Y2UiLCJhY2MiLCJub3JtYWxpemVTdHJpbmdNYXRjaCIsImxpbmUiLCJ0cmltbWVkTGluZSIsImxvY2FsUGF0aCIsInJlc29sdmUiLCJ3cml0ZUZpbGUiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0RGV2aWNlTGFuZ3VhZ2UiLCJnZXREZXZpY2VTeXNMYW5ndWFnZSIsImdldERldmljZVByb2R1Y3RMYW5ndWFnZSIsImdldERldmljZUxvY2FsZSIsImdldERldmljZUNvdW50cnkiLCJjb3VudHJ5IiwiZ2V0RGV2aWNlU3lzQ291bnRyeSIsImdldERldmljZVByb2R1Y3RDb3VudHJ5IiwibG9jYWxlIiwiZ2V0RGV2aWNlU3lzTG9jYWxlIiwiZ2V0RGV2aWNlUHJvZHVjdExvY2FsZSIsInNldERldmljZUxvY2FsZSIsInZhbGlkYXRlTG9jYWxlIiwic3BsaXRfbG9jYWxlIiwic2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5IiwiZW5zdXJlQ3VycmVudExvY2FsZSIsInNjcmlwdCIsImhhc0xhbmd1YWdlIiwiaGFzQ291bnRyeSIsImN1ckxhbmd1YWdlIiwiY3VyQ291bnRyeSIsImN1ckxvY2FsZSIsImxvY2FsZUNvZGUiLCJlcnJvciIsInJlc3RhcnRBZGIiLCJ0b1VwcGVyQ2FzZSIsInNldERldmljZVN5c0xvY2FsZVZpYVNldHRpbmdBcHAiLCJleGlzdHMiLCJleHRyYWN0QmFzZUFwayIsIm1hdGNoZXMiLCJyZXN1bHQiLCJ2ZXJzaW9uTmFtZU1hdGNoIiwidmVyc2lvbkNvZGVNYXRjaCIsInB1bGxBcGsiLCJ0bXBEaXIiLCJwa2dQYXRoIiwidG1wQXBwIiwicHVsbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLElBQUlBLGVBQWUsR0FBRyxFQUF0QjtBQUVBLE1BQU1DLCtCQUErQixHQUNuQyx5R0FERjtBQUVBRCxlQUFlLENBQUNFLGlCQUFoQixHQUFvQztBQUNsQ0MsRUFBQUEsT0FBTyxFQUFFLFNBRHlCO0FBRWxDQyxFQUFBQSxhQUFhLEVBQUUsY0FG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Q0FBQzNFLFdBQVAsR0FBcUJ4RixRQUFRLENBQUNxSyxnQkFBZ0IsQ0FBQyxDQUFELENBQWpCLEVBQXNCLEVBQXRCLENBQTdCO0FBQ0Q7O0FBQ0QsYUFBT0YsTUFBUDtBQUNELEtBWEQsQ0FXRSxPQUFPakYsR0FBUCxFQUFZO0FBQ1p2SixzQkFBSXFJLElBQUosQ0FBVSxVQUFTa0IsR0FBRyxDQUFDM0ksT0FBUSw4QkFBL0I7QUFDRDs7QUFDRCxXQUFPNE4sTUFBUDtBQUNELEdBbEJEOztBQUFBLGtCQUFnRDdFLGNBQWhEO0FBQUE7QUFBQTtBQUFBOztBQW9CQXRLLGVBQWUsQ0FBQ3NQLE9BQWhCO0FBQUEsaURBQTBCLFdBQXdCNU8sR0FBeEIsRUFBNkI2TyxNQUE3QixFQUFxQztBQUM3RCxVQUFNQyxPQUFPLEdBQUcsT0FBTyxLQUFLM0osT0FBTCxDQUFhLENBQUMsT0FBRCxFQUFVLElBQVYsRUFBZ0IsTUFBaEIsRUFBd0JuRixHQUF4QixDQUFiLENBQVAsRUFBbURpQixPQUFuRCxDQUEyRCxVQUEzRCxFQUF1RSxFQUF2RSxDQUFoQjs7QUFDQSxVQUFNOE4sTUFBTSxHQUFHakosY0FBS3lHLE9BQUwsQ0FBYXNDLE1BQWIsRUFBc0IsR0FBRTdPLEdBQUksTUFBNUIsQ0FBZjs7QUFDQSxVQUFNLEtBQUtnUCxJQUFMLENBQVVGLE9BQVYsRUFBbUJDLE1BQW5CLENBQU47O0FBQ0E5TyxvQkFBSUMsS0FBSixDQUFXLDJCQUEwQkYsR0FBSSxTQUFRK08sTUFBTyxHQUF4RDs7QUFDQSxXQUFPQSxNQUFQO0FBQ0QsR0FORDs7QUFBQSxrQkFBeUNILE9BQXpDO0FBQUE7QUFBQTtBQUFBOztlQVNldFAsZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGJ1aWxkU3RhcnRDbWQsIEFQS1NfRVhURU5TSU9OLCBidWlsZEluc3RhbGxBcmdzLFxuICBBUEtfSU5TVEFMTF9USU1FT1VULCBERUZBVUxUX0FEQl9FWEVDX1RJTUVPVVQgfSBmcm9tICcuLi9oZWxwZXJzLmpzJztcbmltcG9ydCB7IGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IGxvZyBmcm9tICcuLi9sb2dnZXIuanMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgcmV0cnlJbnRlcnZhbCB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IGZzLCB1dGlsLCBta2RpcnAgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7XG5pbXBvcnQgb3MgZnJvbSAnb3MnO1xuaW1wb3J0IExSVSBmcm9tICdscnUtY2FjaGUnO1xuXG5sZXQgYXBrVXRpbHNNZXRob2RzID0ge307XG5cbmNvbnN0IEFDVElWSVRJRVNfVFJPVUJMRVNIT09USU5HX0xJTksgPVxuICAnaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vYmxvYi9tYXN0ZXIvZG9jcy9lbi93cml0aW5nLXJ1bm5pbmctYXBwaXVtL2FuZHJvaWQvYWN0aXZpdHktc3RhcnR1cC5tZCc7XG5hcGtVdGlsc01ldGhvZHMuQVBQX0lOU1RBTExfU1RBVEUgPSB7XG4gIFVOS05PV046ICd1bmtub3duJyxcbiAgTk9UX0lOU1RBTExFRDogJ25vdEluc3RhbGxlZCcsXG4gIE5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEOiAnbmV3ZXJWZXJzaW9uSW5zdGFsbGVkJyxcbiAgU0FNRV9WRVJTSU9OX0lOU1RBTExFRDogJ3NhbWVWZXJzaW9uSW5zdGFsbGVkJyxcbiAgT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQ6ICdvbGRlclZlcnNpb25JbnN0YWxsZWQnLFxufTtcbmNvbnN0IFJFTU9URV9DQUNIRV9ST09UID0gJy9kYXRhL2xvY2FsL3RtcC9hcHBpdW1fY2FjaGUnO1xuXG5cbi8qKlxuICogQ2hlY2sgd2hldGhlciB0aGUgcGFydGljdWxhciBwYWNrYWdlIGlzIHByZXNlbnQgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byBjaGVjay5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHBhY2thZ2UgaXMgaW5zdGFsbGVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBkZXRlY3RpbmcgYXBwbGljYXRpb24gc3RhdGVcbiAqL1xuYXBrVXRpbHNNZXRob2RzLmlzQXBwSW5zdGFsbGVkID0gYXN5bmMgZnVuY3Rpb24gaXNBcHBJbnN0YWxsZWQgKHBrZykge1xuICBsb2cuZGVidWcoYEdldHRpbmcgaW5zdGFsbCBzdGF0dXMgZm9yICR7cGtnfWApO1xuICBjb25zdCBpbnN0YWxsZWRQYXR0ZXJuID0gbmV3IFJlZ0V4cChgXlxcXFxzKlBhY2thZ2VcXFxccytcXFxcWyR7Xy5lc2NhcGVSZWdFeHAocGtnKX1cXFxcXVteOl0rOiRgLCAnbScpO1xuICB0cnkge1xuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoWydkdW1wc3lzJywgJ3BhY2thZ2UnLCBwa2ddKTtcbiAgICBjb25zdCBpc0luc3RhbGxlZCA9IGluc3RhbGxlZFBhdHRlcm4udGVzdChzdGRvdXQpO1xuICAgIGxvZy5kZWJ1ZyhgJyR7cGtnfScgaXMkeyFpc0luc3RhbGxlZCA/ICcgbm90JyA6ICcnfSBpbnN0YWxsZWRgKTtcbiAgICByZXR1cm4gaXNJbnN0YWxsZWQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGZpbmRpbmcgaWYgJyR7cGtnfScgaXMgaW5zdGFsbGVkLiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogU3RhcnQgdGhlIHBhcnRpY3VsYXIgVVJJIG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJpIC0gVGhlIG5hbWUgb2YgVVJJIHRvIHN0YXJ0LlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHN0YXJ0IHRoZSBVUkkgd2l0aC5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLnN0YXJ0VXJpID0gYXN5bmMgZnVuY3Rpb24gc3RhcnRVcmkgKHVyaSwgcGtnKSB7XG4gIGlmICghdXJpIHx8ICFwa2cpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VSSSBhbmQgcGFja2FnZSBhcmd1bWVudHMgYXJlIHJlcXVpcmVkJyk7XG4gIH1cblxuICBjb25zdCBhcmdzID0gW1xuICAgICdhbScsICdzdGFydCcsXG4gICAgJy1XJyxcbiAgICAnLWEnLCAnYW5kcm9pZC5pbnRlbnQuYWN0aW9uLlZJRVcnLFxuICAgICctZCcsIHVyaS5yZXBsYWNlKC8mL2csICdcXFxcJicpLFxuICAgIHBrZyxcbiAgXTtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNoZWxsKGFyZ3MpO1xuICAgIGlmIChyZXMudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndW5hYmxlIHRvIHJlc29sdmUgaW50ZW50JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihyZXMpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgYXR0ZW1wdGluZyB0byBzdGFydCBVUkkuIE9yaWdpbmFsIGVycm9yOiAke2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU3RhcnRBcHBPcHRpb25zXG4gKiBAcHJvcGVydHkgeyFzdHJpbmd9IGFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgdGhlIG1haW4gYXBwbGljYXRpb24gYWN0aXZpdHlcbiAqIEBwcm9wZXJ0eSB7IXN0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIGFwcGxpY2F0aW9uIHBhY2thZ2VcbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHJldHJ5IFt0cnVlXSAtIElmIHRoaXMgcHJvcGVydHkgaXMgc2V0IHRvIGB0cnVlYFxuICogYW5kIHRoZSBhY3Rpdml0eSBuYW1lIGRvZXMgbm90IHN0YXJ0IHdpdGggJy4nIHRoZW4gdGhlIG1ldGhvZFxuICogd2lsbCB0cnkgdG8gYWRkIHRoZSBtaXNzaW5nIGRvdCBhbmQgc3RhcnQgdGhlIGFjdGl2aXR5IG9uY2UgbW9yZVxuICogaWYgdGhlIGZpcnN0IHN0YXJ0dXAgdHJ5IGZhaWxzLlxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gc3RvcEFwcCBbdHJ1ZV0gLSBTZXQgaXQgdG8gYHRydWVgIGluIG9yZGVyIHRvIGZvcmNlZnVsbHlcbiAqIHN0b3AgdGhlIGFjdGl2aXR5IGlmIGl0IGlzIGFscmVhZHkgcnVubmluZy5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gd2FpdFBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHdhaXQgdG8gb25cbiAqIHN0YXJ0dXAgKHRoaXMgb25seSBtYWtlcyBzZW5zZSBpZiB0aGlzIG5hbWUgaXMgZGlmZmVyZW50IGZyb20gdGhlIG9uZSwgd2hpY2ggaXMgc2V0IGFzIGBwa2dgKVxuICogQHByb3BlcnR5IHs/c3RyaW5nfSB3YWl0QWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgYWN0aXZpdHkgdG8gd2FpdCB0byBvblxuICogc3RhcnR1cCAodGhpcyBvbmx5IG1ha2VzIHNlbnNlIGlmIHRoaXMgbmFtZSBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgb25lLCB3aGljaCBpcyBzZXQgYXMgYGFjdGl2aXR5YClcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gd2FpdER1cmF0aW9uIC0gVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqIGB3YWl0QWN0aXZpdHlgIGlzIGZvY3VzZWRcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ3xudW1iZXJ9IHVzZXIgLSBUaGUgbnVtYmVyIG9mIHRoZSB1c2VyIHByb2ZpbGUgdG8gc3RhcnRcbiAqIHRoZSBnaXZlbiBhY3Rpdml0eSB3aXRoLiBUaGUgZGVmYXVsdCBPUyB1c2VyIHByb2ZpbGUgKHVzdWFsbHkgemVybykgaXMgdXNlZFxuICogd2hlbiB0aGlzIHByb3BlcnR5IGlzIHVuc2V0XG4gKi9cblxuLyoqXG4gKiBTdGFydCB0aGUgcGFydGljdWxhciBwYWNrYWdlL2FjdGl2aXR5IG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge1N0YXJ0QXBwT3B0aW9uc30gc3RhcnRBcHBPcHRpb25zIFt7fV0gLSBTdGFydHVwIG9wdGlvbnMgbWFwcGluZy5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIG91dHB1dCBvZiB0aGUgY29ycmVzcG9uZGluZyBhZGIgY29tbWFuZC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSBpcyBhbiBlcnJvciB3aGlsZSBleGVjdXRpbmcgdGhlIGFjdGl2aXR5XG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5zdGFydEFwcCA9IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0QXBwIChzdGFydEFwcE9wdGlvbnMgPSB7fSkge1xuICBpZiAoIXN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eSB8fCAhc3RhcnRBcHBPcHRpb25zLnBrZykge1xuICAgIHRocm93IG5ldyBFcnJvcignYWN0aXZpdHkgYW5kIHBrZyBhcmUgcmVxdWlyZWQgdG8gc3RhcnQgYW4gYXBwbGljYXRpb24nKTtcbiAgfVxuXG4gIHN0YXJ0QXBwT3B0aW9ucyA9IF8uY2xvbmUoc3RhcnRBcHBPcHRpb25zKTtcbiAgc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5ID0gc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5LnJlcGxhY2UoJyQnLCAnXFxcXCQnKTtcbiAgLy8gaW5pdGlhbGl6aW5nIGRlZmF1bHRzXG4gIF8uZGVmYXVsdHMoc3RhcnRBcHBPcHRpb25zLCB7XG4gICAgd2FpdFBrZzogc3RhcnRBcHBPcHRpb25zLnBrZyxcbiAgICB3YWl0QWN0aXZpdHk6IGZhbHNlLFxuICAgIHJldHJ5OiB0cnVlLFxuICAgIHN0b3BBcHA6IHRydWVcbiAgfSk7XG4gIC8vIHByZXZlbnRpbmcgbnVsbCB3YWl0cGtnXG4gIHN0YXJ0QXBwT3B0aW9ucy53YWl0UGtnID0gc3RhcnRBcHBPcHRpb25zLndhaXRQa2cgfHwgc3RhcnRBcHBPcHRpb25zLnBrZztcblxuICBjb25zdCBhcGlMZXZlbCA9IGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKTtcbiAgY29uc3QgY21kID0gYnVpbGRTdGFydENtZChzdGFydEFwcE9wdGlvbnMsIGFwaUxldmVsKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBzaGVsbE9wdHMgPSB7fTtcbiAgICBpZiAoXy5pc0ludGVnZXIoc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbikgJiYgc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbiA+IDIwMDAwKSB7XG4gICAgICBzaGVsbE9wdHMudGltZW91dCA9IHN0YXJ0QXBwT3B0aW9ucy53YWl0RHVyYXRpb247XG4gICAgfVxuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoY21kLCBzaGVsbE9wdHMpO1xuICAgIGlmIChzdGRvdXQuaW5jbHVkZXMoJ0Vycm9yOiBBY3Rpdml0eSBjbGFzcycpICYmIHN0ZG91dC5pbmNsdWRlcygnZG9lcyBub3QgZXhpc3QnKSkge1xuICAgICAgaWYgKHN0YXJ0QXBwT3B0aW9ucy5yZXRyeSAmJiAhc3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5LnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgICAgICBsb2cuZGVidWcoYFdlIHRyaWVkIHRvIHN0YXJ0IGFuIGFjdGl2aXR5IHRoYXQgZG9lc24ndCBleGlzdCwgYCArXG4gICAgICAgICAgICAgICAgICBgcmV0cnlpbmcgd2l0aCAnLiR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fScgYWN0aXZpdHkgbmFtZWApO1xuICAgICAgICBzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkgPSBgLiR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fWA7XG4gICAgICAgIHN0YXJ0QXBwT3B0aW9ucy5yZXRyeSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5zdGFydEFwcChzdGFydEFwcE9wdGlvbnMpO1xuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY3Rpdml0eSBuYW1lICcke3N0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eX0nIHVzZWQgdG8gc3RhcnQgdGhlIGFwcCBkb2Vzbid0IGAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBleGlzdCBvciBjYW5ub3QgYmUgbGF1bmNoZWQhIE1ha2Ugc3VyZSBpdCBleGlzdHMgYW5kIGlzIGEgbGF1bmNoYWJsZSBhY3Rpdml0eWApO1xuICAgIH0gZWxzZSBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdqYXZhLmxhbmcuU2VjdXJpdHlFeGNlcHRpb24nKSkge1xuICAgICAgLy8gaWYgdGhlIGFwcCBpcyBkaXNhYmxlZCBvbiBhIHJlYWwgZGV2aWNlIGl0IHdpbGwgdGhyb3cgYSBzZWN1cml0eSBleGNlcHRpb25cbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHBlcm1pc3Npb24gdG8gc3RhcnQgJyR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fScgYWN0aXZpdHkgaGFzIGJlZW4gZGVuaWVkLmAgK1xuICAgICAgICAgICAgICAgICAgICAgIGBNYWtlIHN1cmUgdGhlIGFjdGl2aXR5L3BhY2thZ2UgbmFtZXMgYXJlIGNvcnJlY3QuYCk7XG4gICAgfVxuICAgIGlmIChzdGFydEFwcE9wdGlvbnMud2FpdEFjdGl2aXR5KSB7XG4gICAgICBhd2FpdCB0aGlzLndhaXRGb3JBY3Rpdml0eShzdGFydEFwcE9wdGlvbnMud2FpdFBrZywgc3RhcnRBcHBPcHRpb25zLndhaXRBY3Rpdml0eSwgc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbik7XG4gICAgfVxuICAgIHJldHVybiBzdGRvdXQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBzdGFydCB0aGUgJyR7c3RhcnRBcHBPcHRpb25zLnBrZ30nIGFwcGxpY2F0aW9uLiBgICtcbiAgICAgIGBWaXNpdCAke0FDVElWSVRJRVNfVFJPVUJMRVNIT09USU5HX0xJTkt9IGZvciB0cm91Ymxlc2hvb3RpbmcuIGAgK1xuICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBIZWxwZXIgbWV0aG9kIHRvIGNhbGwgYGFkYiBkdW1wc3lzIHdpbmRvdyB3aW5kb3dzL2Rpc3BsYXlzYFxuICovXG5hcGtVdGlsc01ldGhvZHMuZHVtcFdpbmRvd3MgPSBhc3luYyBmdW5jdGlvbiBkdW1wV2luZG93cyAoKSB7XG4gIGNvbnN0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuXG4gIC8vIFdpdGggdmVyc2lvbiAyOSwgQW5kcm9pZCBjaGFuZ2VkIHRoZSBkdW1wc3lzIHN5bnRheFxuICBjb25zdCBkdW1wc3lzQXJnID0gYXBpTGV2ZWwgPj0gMjkgPyAnZGlzcGxheXMnIDogJ3dpbmRvd3MnO1xuICBjb25zdCBjbWQgPSBbJ2R1bXBzeXMnLCAnd2luZG93JywgZHVtcHN5c0FyZ107XG5cbiAgcmV0dXJuIGF3YWl0IHRoaXMuc2hlbGwoY21kKTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUGFja2FnZUFjdGl2aXR5SW5mb1xuICogQHByb3BlcnR5IHs/c3RyaW5nfSBhcHBQYWNrYWdlIC0gVGhlIG5hbWUgb2YgYXBwbGljYXRpb24gcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBleGFtcGxlICdjb20uYWNtZS5hcHAnLlxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBhcHBBY3Rpdml0eSAtIFRoZSBuYW1lIG9mIG1haW4gYXBwbGljYXRpb24gYWN0aXZpdHkuXG4gKi9cblxuLyoqXG4gKiBHZXQgdGhlIG5hbWUgb2YgY3VycmVudGx5IGZvY3VzZWQgcGFja2FnZSBhbmQgYWN0aXZpdHkuXG4gKlxuICogQHJldHVybiB7UGFja2FnZUFjdGl2aXR5SW5mb30gVGhlIG1hcHBpbmcsIHdoZXJlIHByb3BlcnR5IG5hbWVzIGFyZSAnYXBwUGFja2FnZScgYW5kICdhcHBBY3Rpdml0eScuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcGFyc2luZyB0aGUgZGF0YS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkgPSBhc3luYyBmdW5jdGlvbiBnZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5ICgpIHtcbiAgbG9nLmRlYnVnKCdHZXR0aW5nIGZvY3VzZWQgcGFja2FnZSBhbmQgYWN0aXZpdHknKTtcbiAgY29uc3QgbnVsbEZvY3VzZWRBcHBSZSA9IG5ldyBSZWdFeHAoL15cXHMqbUZvY3VzZWRBcHA9bnVsbC8sICdtJyk7XG4gIC8vIGh0dHBzOi8vcmVnZXgxMDEuY29tL3IveFo4dkY3LzFcbiAgY29uc3QgZm9jdXNlZEFwcFJlID0gbmV3IFJlZ0V4cCgnXlxcXFxzKm1Gb2N1c2VkQXBwLitSZWNvcmRcXFxcey4qXFxcXHMoW15cXFxcc1xcXFwvXFxcXH1dKyknICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFxcXC8oW15cXFxcc1xcXFwvXFxcXH1cXFxcLF0rKVxcXFwsPyhcXFxcc1teXFxcXHNcXFxcL1xcXFx9XSspKlxcXFx9JywgJ20nKTtcbiAgY29uc3QgbnVsbEN1cnJlbnRGb2N1c1JlID0gbmV3IFJlZ0V4cCgvXlxccyptQ3VycmVudEZvY3VzPW51bGwvLCAnbScpO1xuICBjb25zdCBjdXJyZW50Rm9jdXNBcHBSZSA9IG5ldyBSZWdFeHAoJ15cXFxccyptQ3VycmVudEZvY3VzLitcXFxcey4rXFxcXHMoW15cXFxcc1xcXFwvXSspXFxcXC8oW15cXFxcc10rKVxcXFxiJywgJ20nKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuZHVtcFdpbmRvd3MoKTtcbiAgICAvLyBUaGUgb3JkZXIgbWF0dGVycyBoZXJlXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIFtmb2N1c2VkQXBwUmUsIGN1cnJlbnRGb2N1c0FwcFJlXSkge1xuICAgICAgY29uc3QgbWF0Y2ggPSBwYXR0ZXJuLmV4ZWMoc3Rkb3V0KTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFwcFBhY2thZ2U6IG1hdGNoWzFdLnRyaW0oKSxcbiAgICAgICAgICBhcHBBY3Rpdml0eTogbWF0Y2hbMl0udHJpbSgpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIFtudWxsRm9jdXNlZEFwcFJlLCBudWxsQ3VycmVudEZvY3VzUmVdKSB7XG4gICAgICBpZiAocGF0dGVybi5leGVjKHN0ZG91dCkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhcHBQYWNrYWdlOiBudWxsLFxuICAgICAgICAgIGFwcEFjdGl2aXR5OiBudWxsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcGFyc2UgYWN0aXZpdHkgZnJvbSBkdW1wc3lzJyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBnZXQgZm9jdXNQYWNrYWdlQW5kQWN0aXZpdHkuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBXYWl0IGZvciB0aGUgZ2l2ZW4gYWN0aXZpdHkgdG8gYmUgZm9jdXNlZC9ub24tZm9jdXNlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gd2FpdCBmb3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgYWN0aXZpdHksIGJlbG9uZ2luZyB0byB0aGF0IHBhY2thZ2UsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gd2FpdEZvclN0b3AgLSBXaGV0aGVyIHRvIHdhaXQgdW50aWwgdGhlIGFjdGl2aXR5IGlzIGZvY3VzZWQgKHRydWUpXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgaXMgbm90IGZvY3VzZWQgKGZhbHNlKS5cbiAqIEBwYXJhbSB7bnVtYmVyfSB3YWl0TXMgWzIwMDAwXSAtIE51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCBiZWZvcmUgdGltZW91dCBvY2N1cnMuXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGltZW91dCBoYXBwZW5zLlxuICovXG5hcGtVdGlsc01ldGhvZHMud2FpdEZvckFjdGl2aXR5T3JOb3QgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yQWN0aXZpdHlPck5vdCAocGtnLCBhY3Rpdml0eSwgd2FpdEZvclN0b3AsIHdhaXRNcyA9IDIwMDAwKSB7XG4gIGlmICghcGtnIHx8ICFhY3Rpdml0eSkge1xuICAgIHRocm93IG5ldyBFcnJvcignUGFja2FnZSBhbmQgYWN0aXZpdHkgcmVxdWlyZWQuJyk7XG4gIH1cbiAgbG9nLmRlYnVnKGBXYWl0aW5nIHVwIHRvICR7d2FpdE1zfW1zIGZvciBhY3Rpdml0eSBtYXRjaGluZyBwa2c6ICcke3BrZ30nIGFuZCBgICtcbiAgICAgICAgICAgIGBhY3Rpdml0eTogJyR7YWN0aXZpdHl9JyB0byR7d2FpdEZvclN0b3AgPyAnIG5vdCcgOiAnJ30gYmUgZm9jdXNlZGApO1xuXG4gIGNvbnN0IHNwbGl0TmFtZXMgPSAobmFtZXMpID0+IG5hbWVzLnNwbGl0KCcsJykubWFwKChuYW1lKSA9PiBuYW1lLnRyaW0oKSk7XG5cbiAgY29uc3QgYWxsUGFja2FnZXMgPSBzcGxpdE5hbWVzKHBrZyk7XG4gIGNvbnN0IGFsbEFjdGl2aXRpZXMgPSBzcGxpdE5hbWVzKGFjdGl2aXR5KTtcblxuICBsZXQgcG9zc2libGVBY3Rpdml0eU5hbWVzID0gW107XG4gIGZvciAobGV0IG9uZUFjdGl2aXR5IG9mIGFsbEFjdGl2aXRpZXMpIHtcbiAgICBpZiAob25lQWN0aXZpdHkuc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAvLyBhZGQgdGhlIHBhY2thZ2UgbmFtZSBpZiBhY3Rpdml0eSBpcyBub3QgZnVsbCBxdWFsaWZpZWRcbiAgICAgIGZvciAobGV0IGN1cnJlbnRQa2cgb2YgYWxsUGFja2FnZXMpIHtcbiAgICAgICAgcG9zc2libGVBY3Rpdml0eU5hbWVzLnB1c2goYCR7Y3VycmVudFBrZ30ke29uZUFjdGl2aXR5fWAucmVwbGFjZSgvXFwuKy9nLCAnLicpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYWNjZXB0IGZ1bGx5IHF1YWxpZmllZCBhY3Rpdml0eSBuYW1lLlxuICAgICAgcG9zc2libGVBY3Rpdml0eU5hbWVzLnB1c2gob25lQWN0aXZpdHkpO1xuICAgICAgcG9zc2libGVBY3Rpdml0eU5hbWVzLnB1c2goYCR7cGtnfS4ke29uZUFjdGl2aXR5fWApO1xuICAgIH1cbiAgfVxuICBsb2cuZGVidWcoYFBvc3NpYmxlIGFjdGl2aXRpZXMsIHRvIGJlIGNoZWNrZWQ6ICR7cG9zc2libGVBY3Rpdml0eU5hbWVzLm1hcCgobmFtZSkgPT4gYCcke25hbWV9J2ApLmpvaW4oJywgJyl9YCk7XG5cbiAgbGV0IHBvc3NpYmxlQWN0aXZpdHlQYXR0ZXJucyA9IHBvc3NpYmxlQWN0aXZpdHlOYW1lcy5tYXAoKHBvc3NpYmxlQWN0aXZpdHlOYW1lKSA9PlxuICAgIG5ldyBSZWdFeHAoYF4ke3Bvc3NpYmxlQWN0aXZpdHlOYW1lLnJlcGxhY2UoL1xcLi9nLCAnXFxcXC4nKS5yZXBsYWNlKC9cXCovZywgJy4qPycpLnJlcGxhY2UoL1xcJC9nLCAnXFxcXCQnKX0kYClcbiAgKTtcblxuICAvLyBmaWd1cmUgb3V0IHRoZSBudW1iZXIgb2YgcmV0cmllcy4gVHJ5IG9uY2UgaWYgd2FpdE1zIGlzIGxlc3MgdGhhdCA3NTBcbiAgLy8gMzAgdGltZXMgaWYgcGFyc2luZyBpcyBub3QgcG9zc2libGVcbiAgbGV0IHJldHJpZXMgPSBwYXJzZUludCh3YWl0TXMgLyA3NTAsIDEwKSB8fCAxO1xuICByZXRyaWVzID0gaXNOYU4ocmV0cmllcykgPyAzMCA6IHJldHJpZXM7XG4gIGF3YWl0IHJldHJ5SW50ZXJ2YWwocmV0cmllcywgNzUwLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IHthcHBQYWNrYWdlLCBhcHBBY3Rpdml0eX0gPSBhd2FpdCB0aGlzLmdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkoKTtcbiAgICBpZiAoYXBwQWN0aXZpdHkgJiYgYXBwUGFja2FnZSkge1xuICAgICAgbGV0IGZ1bGx5UXVhbGlmaWVkQWN0aXZpdHkgPSBhcHBBY3Rpdml0eS5zdGFydHNXaXRoKCcuJykgPyBgJHthcHBQYWNrYWdlfSR7YXBwQWN0aXZpdHl9YCA6IGFwcEFjdGl2aXR5O1xuICAgICAgbG9nLmRlYnVnKGBGb3VuZCBwYWNrYWdlOiAnJHthcHBQYWNrYWdlfScgYW5kIGZ1bGx5IHF1YWxpZmllZCBhY3Rpdml0eSBuYW1lIDogJyR7ZnVsbHlRdWFsaWZpZWRBY3Rpdml0eX0nYCk7XG4gICAgICBsZXQgZm91bmRBY3QgPSAoXy5pbmNsdWRlcyhhbGxQYWNrYWdlcywgYXBwUGFja2FnZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICBfLmZpbmRJbmRleChwb3NzaWJsZUFjdGl2aXR5UGF0dGVybnMsIChwb3NzaWJsZVBhdHRlcm4pID0+IHBvc3NpYmxlUGF0dGVybi50ZXN0KGZ1bGx5UXVhbGlmaWVkQWN0aXZpdHkpKSAhPT0gLTEpO1xuICAgICAgaWYgKCghd2FpdEZvclN0b3AgJiYgZm91bmRBY3QpIHx8ICh3YWl0Rm9yU3RvcCAmJiAhZm91bmRBY3QpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgbG9nLmRlYnVnKCdJbmNvcnJlY3QgcGFja2FnZSBhbmQgYWN0aXZpdHkuIFJldHJ5aW5nLicpO1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtwb3NzaWJsZUFjdGl2aXR5TmFtZXMubWFwKChuYW1lKSA9PiBgJyR7bmFtZX0nYCkuam9pbignIG9yICcpfSBuZXZlciAke3dhaXRGb3JTdG9wID8gJ3N0b3BwZWQnIDogJ3N0YXJ0ZWQnfS4gYCArXG4gICAgICBgVmlzaXQgJHtBQ1RJVklUSUVTX1RST1VCTEVTSE9PVElOR19MSU5LfSBmb3IgdHJvdWJsZXNob290aW5nYCk7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBXYWl0IGZvciB0aGUgZ2l2ZW4gYWN0aXZpdHkgdG8gYmUgZm9jdXNlZFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBhY3Rpdml0eSwgYmVsb25naW5nIHRvIHRoYXQgcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtudW1iZXJ9IHdhaXRNcyBbMjAwMDBdIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSB0aW1lb3V0IG9jY3Vycy5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aW1lb3V0IGhhcHBlbnMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy53YWl0Rm9yQWN0aXZpdHkgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yQWN0aXZpdHkgKHBrZywgYWN0LCB3YWl0TXMgPSAyMDAwMCkge1xuICBhd2FpdCB0aGlzLndhaXRGb3JBY3Rpdml0eU9yTm90KHBrZywgYWN0LCBmYWxzZSwgd2FpdE1zKTtcbn07XG5cbi8qKlxuICogV2FpdCBmb3IgdGhlIGdpdmVuIGFjdGl2aXR5IHRvIGJlIG5vbi1mb2N1c2VkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBhY3Rpdml0eSwgYmVsb25naW5nIHRvIHRoYXQgcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtudW1iZXJ9IHdhaXRNcyBbMjAwMDBdIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSB0aW1lb3V0IG9jY3Vycy5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aW1lb3V0IGhhcHBlbnMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy53YWl0Rm9yTm90QWN0aXZpdHkgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yTm90QWN0aXZpdHkgKHBrZywgYWN0LCB3YWl0TXMgPSAyMDAwMCkge1xuICBhd2FpdCB0aGlzLndhaXRGb3JBY3Rpdml0eU9yTm90KHBrZywgYWN0LCB0cnVlLCB3YWl0TXMpO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBVbmluc3RhbGxPcHRpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBbYWRiRXhlY1RpbWVvdXRdIC0gVGhlIGNvdW50IG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyB1bmluc3RhbGxlZC5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0ga2VlcERhdGEgW2ZhbHNlXSAtIFNldCB0byB0cnVlIGluIG9yZGVyIHRvIGtlZXAgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbiBkYXRhIGFuZCBjYWNoZSBmb2xkZXJzIGFmdGVyIHVuaW5zdGFsbC5cbiAqL1xuXG4vKipcbiAqIFVuaW5zdGFsbCB0aGUgZ2l2ZW4gcGFja2FnZSBmcm9tIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gYmUgdW5pbnN0YWxsZWQuXG4gKiBAcGFyYW0gez9Vbmluc3RhbGxPcHRpb25zfSBvcHRpb25zIC0gVGhlIHNldCBvZiB1bmluc3RhbGwgb3B0aW9ucy5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHBhY2thZ2Ugd2FzIGZvdW5kIG9uIHRoZSBkZXZpY2UgYW5kXG4gKiAgICAgICAgICAgICAgICAgICBzdWNjZXNzZnVsbHkgdW5pbnN0YWxsZWQuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy51bmluc3RhbGxBcGsgPSBhc3luYyBmdW5jdGlvbiB1bmluc3RhbGxBcGsgKHBrZywgb3B0aW9ucyA9IHt9KSB7XG4gIGxvZy5kZWJ1ZyhgVW5pbnN0YWxsaW5nICR7cGtnfWApO1xuICBpZiAoIWF3YWl0IHRoaXMuaXNBcHBJbnN0YWxsZWQocGtnKSkge1xuICAgIGxvZy5pbmZvKGAke3BrZ30gd2FzIG5vdCB1bmluc3RhbGxlZCwgYmVjYXVzZSBpdCB3YXMgbm90IHByZXNlbnQgb24gdGhlIGRldmljZWApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IGNtZCA9IFsndW5pbnN0YWxsJ107XG4gIGlmIChvcHRpb25zLmtlZXBEYXRhKSB7XG4gICAgY21kLnB1c2goJy1rJyk7XG4gIH1cbiAgY21kLnB1c2gocGtnKTtcblxuICBsZXQgc3Rkb3V0O1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuZm9yY2VTdG9wKHBrZyk7XG4gICAgc3Rkb3V0ID0gKGF3YWl0IHRoaXMuYWRiRXhlYyhjbWQsIHt0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXR9KSkudHJpbSgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gdW5pbnN0YWxsIEFQSy4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG4gIGxvZy5kZWJ1ZyhgJ2FkYiAke2NtZC5qb2luKCcgJyl9JyBjb21tYW5kIG91dHB1dDogJHtzdGRvdXR9YCk7XG4gIGlmIChzdGRvdXQuaW5jbHVkZXMoJ1N1Y2Nlc3MnKSkge1xuICAgIGxvZy5pbmZvKGAke3BrZ30gd2FzIHN1Y2Nlc3NmdWxseSB1bmluc3RhbGxlZGApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGxvZy5pbmZvKGAke3BrZ30gd2FzIG5vdCB1bmluc3RhbGxlZGApO1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIEluc3RhbGwgdGhlIHBhY2thZ2UgYWZ0ZXIgaXQgd2FzIHB1c2hlZCB0byB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwa1BhdGhPbkRldmljZSAtIFRoZSBmdWxsIHBhdGggdG8gdGhlIHBhY2thZ2Ugb24gdGhlIGRldmljZSBmaWxlIHN5c3RlbS5cbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIFt7fV0gLSBBZGRpdGlvbmFsIGV4ZWMgb3B0aW9ucy4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL25vZGUtdGVlbl9wcm9jZXNzfVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtb3JlIGRldGFpbHMgb24gdGhpcyBwYXJhbWV0ZXIuXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGhlcmUgd2FzIGEgZmFpbHVyZSBkdXJpbmcgYXBwbGljYXRpb24gaW5zdGFsbC5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmluc3RhbGxGcm9tRGV2aWNlUGF0aCA9IGFzeW5jIGZ1bmN0aW9uIGluc3RhbGxGcm9tRGV2aWNlUGF0aCAoYXBrUGF0aE9uRGV2aWNlLCBvcHRzID0ge30pIHtcbiAgbGV0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoWydwbScsICdpbnN0YWxsJywgJy1yJywgYXBrUGF0aE9uRGV2aWNlXSwgb3B0cyk7XG4gIGlmIChzdGRvdXQuaW5kZXhPZignRmFpbHVyZScpICE9PSAtMSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgUmVtb3RlIGluc3RhbGwgZmFpbGVkOiAke3N0ZG91dH1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDYWNoaW5nT3B0aW9uc1xuICogQHByb3BlcnR5IHs/bnVtYmVyfSB0aW1lb3V0IFthZGJFeGVjVGltZW91dF0gLSBUaGUgY291bnQgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyB1cGxvYWRlZCB0byB0aGUgcmVtb3RlIGxvY2F0aW9uLlxuICovXG5cbi8qKlxuICogQ2FjaGVzIHRoZSBnaXZlbiBBUEsgYXQgYSByZW1vdGUgbG9jYXRpb24gdG8gc3BlZWQgdXAgZnVydGhlciBBUEsgZGVwbG95bWVudHMuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwa1BhdGggLSBGdWxsIHBhdGggdG8gdGhlIGFwayBvbiB0aGUgbG9jYWwgRlNcbiAqIEBwYXJhbSB7P0NhY2hpbmdPcHRpb25zfSBvcHRpb25zIC0gQ2FjaGluZyBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfSAtIEZ1bGwgcGF0aCB0byB0aGUgY2FjaGVkIGFwayBvbiB0aGUgcmVtb3RlIGZpbGUgc3lzdGVtXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5jYWNoZUFwayA9IGFzeW5jIGZ1bmN0aW9uIGNhY2hlQXBrIChhcGtQYXRoLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgYXBwSGFzaCA9IGF3YWl0IGZzLmhhc2goYXBrUGF0aCk7XG4gIGNvbnN0IHJlbW90ZVBhdGggPSBwYXRoLnBvc2l4LmpvaW4oUkVNT1RFX0NBQ0hFX1JPT1QsIGAke2FwcEhhc2h9LmFwa2ApO1xuICBjb25zdCByZW1vdGVDYWNoZWRGaWxlcyA9IFtdO1xuICAvLyBHZXQgY3VycmVudCBjb250ZW50cyBvZiB0aGUgcmVtb3RlIGNhY2hlIG9yIGNyZWF0ZSBpdCBmb3IgdGhlIGZpcnN0IHRpbWVcbiAgdHJ5IHtcbiAgICBjb25zdCBlcnJvck1hcmtlciA9ICdfRVJST1JfJztcbiAgICBsZXQgbHNPdXRwdXQgPSBudWxsO1xuICAgIGlmICh0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCA9PT0gdHJ1ZSB8fCAhXy5pc0Jvb2xlYW4odGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQpKSB7XG4gICAgICBsc091dHB1dCA9IGF3YWl0IHRoaXMuc2hlbGwoW2BscyAtdCAtMSAke1JFTU9URV9DQUNIRV9ST09UfSAyPiYxIHx8IGVjaG8gJHtlcnJvck1hcmtlcn1gXSk7XG4gICAgfVxuICAgIGlmICghXy5pc1N0cmluZyhsc091dHB1dCkgfHwgKGxzT3V0cHV0LmluY2x1ZGVzKGVycm9yTWFya2VyKSAmJiAhbHNPdXRwdXQuaW5jbHVkZXMoUkVNT1RFX0NBQ0hFX1JPT1QpKSkge1xuICAgICAgaWYgKCFfLmlzQm9vbGVhbih0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCkpIHtcbiAgICAgICAgbG9nLmRlYnVnKCdUaGUgY3VycmVudCBBbmRyb2lkIEFQSSBkb2VzIG5vdCBzdXBwb3J0IGV4dGVuZGVkIGxzIG9wdGlvbnMuICcgK1xuICAgICAgICAgICdEZWZhdWx0aW5nIHRvIG5vLW9wdGlvbnMgY2FsbCcpO1xuICAgICAgfVxuICAgICAgbHNPdXRwdXQgPSBhd2FpdCB0aGlzLnNoZWxsKFtgbHMgJHtSRU1PVEVfQ0FDSEVfUk9PVH0gMj4mMSB8fCBlY2hvICR7ZXJyb3JNYXJrZXJ9YF0pO1xuICAgICAgdGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAobHNPdXRwdXQuaW5jbHVkZXMoZXJyb3JNYXJrZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IobHNPdXRwdXQuc3Vic3RyaW5nKDAsIGxzT3V0cHV0LmluZGV4T2YoZXJyb3JNYXJrZXIpKSk7XG4gICAgfVxuICAgIHJlbW90ZUNhY2hlZEZpbGVzLnB1c2goLi4uKFxuICAgICAgbHNPdXRwdXQuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5tYXAoKHgpID0+IHgudHJpbSgpKVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgKSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2cuZGVidWcoYEdvdCBhbiBlcnJvciAnJHtlLm1lc3NhZ2UudHJpbSgpfScgd2hpbGUgZ2V0dGluZyB0aGUgbGlzdCBvZiBmaWxlcyBpbiB0aGUgY2FjaGUuIGAgK1xuICAgICAgYEFzc3VtaW5nIHRoZSBjYWNoZSBkb2VzIG5vdCBleGlzdCB5ZXRgKTtcbiAgICBhd2FpdCB0aGlzLnNoZWxsKFsnbWtkaXInLCAnLXAnLCBSRU1PVEVfQ0FDSEVfUk9PVF0pO1xuICB9XG4gIGxvZy5kZWJ1ZyhgVGhlIGNvdW50IG9mIGFwcGxpY2F0aW9ucyBpbiB0aGUgY2FjaGU6ICR7cmVtb3RlQ2FjaGVkRmlsZXMubGVuZ3RofWApO1xuICBjb25zdCB0b0hhc2ggPSAocmVtb3RlUGF0aCkgPT4gcGF0aC5wb3NpeC5wYXJzZShyZW1vdGVQYXRoKS5uYW1lO1xuICAvLyBQdXNoIHRoZSBhcGsgdG8gdGhlIHJlbW90ZSBjYWNoZSBpZiBuZWVkZWRcbiAgaWYgKHJlbW90ZUNhY2hlZEZpbGVzLmZpbmQoKHgpID0+IHRvSGFzaCh4KSA9PT0gYXBwSGFzaCkpIHtcbiAgICBsb2cuaW5mbyhgVGhlIGFwcGxpY2F0aW9uIGF0ICcke2Fwa1BhdGh9JyBpcyBhbHJlYWR5IGNhY2hlZCB0byAnJHtyZW1vdGVQYXRofSdgKTtcbiAgfSBlbHNlIHtcbiAgICBsb2cuaW5mbyhgQ2FjaGluZyB0aGUgYXBwbGljYXRpb24gYXQgJyR7YXBrUGF0aH0nIHRvICcke3JlbW90ZVBhdGh9J2ApO1xuICAgIGNvbnN0IHN0YXJ0ZWQgPSBwcm9jZXNzLmhydGltZSgpO1xuICAgIGF3YWl0IHRoaXMucHVzaChhcGtQYXRoLCByZW1vdGVQYXRoLCB7dGltZW91dDogb3B0aW9ucy50aW1lb3V0fSk7XG4gICAgY29uc3QgW3NlY29uZHMsIG5hbm9zXSA9IHByb2Nlc3MuaHJ0aW1lKHN0YXJ0ZWQpO1xuICAgIGNvbnN0IHtzaXplfSA9IGF3YWl0IGZzLnN0YXQoYXBrUGF0aCk7XG4gICAgbG9nLmluZm8oYFRoZSB1cGxvYWQgb2YgJyR7cGF0aC5iYXNlbmFtZShhcGtQYXRoKX0nICgke3V0aWwudG9SZWFkYWJsZVNpemVTdHJpbmcoc2l6ZSl9KSBgICtcbiAgICAgIGB0b29rICR7KHNlY29uZHMgKyBuYW5vcyAvIDFlOSkudG9GaXhlZCgzKX1zYCk7XG4gIH1cbiAgaWYgKCF0aGlzLnJlbW90ZUFwcHNDYWNoZSkge1xuICAgIHRoaXMucmVtb3RlQXBwc0NhY2hlID0gbmV3IExSVSh7XG4gICAgICBtYXg6IHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQsXG4gICAgfSk7XG4gIH1cbiAgLy8gQ2xlYW51cCB0aGUgaW52YWxpZCBlbnRyaWVzIGZyb20gdGhlIGNhY2hlXG4gIF8uZGlmZmVyZW5jZSh0aGlzLnJlbW90ZUFwcHNDYWNoZS5rZXlzKCksIHJlbW90ZUNhY2hlZEZpbGVzLm1hcCh0b0hhc2gpKVxuICAgIC5mb3JFYWNoKChoYXNoKSA9PiB0aGlzLnJlbW90ZUFwcHNDYWNoZS5kZWwoaGFzaCkpO1xuICAvLyBCdW1wIHRoZSBjYWNoZSByZWNvcmQgZm9yIHRoZSByZWNlbnRseSBjYWNoZWQgaXRlbVxuICB0aGlzLnJlbW90ZUFwcHNDYWNoZS5zZXQoYXBwSGFzaCwgcmVtb3RlUGF0aCk7XG4gIC8vIElmIHRoZSByZW1vdGUgY2FjaGUgZXhjZWVkcyB0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0LCByZW1vdmUgdGhlIGxlYXN0IHJlY2VudGx5IHVzZWQgZW50cmllc1xuICBjb25zdCBlbnRyaWVzVG9DbGVhbnVwID0gcmVtb3RlQ2FjaGVkRmlsZXNcbiAgICAubWFwKCh4KSA9PiBwYXRoLnBvc2l4LmpvaW4oUkVNT1RFX0NBQ0hFX1JPT1QsIHgpKVxuICAgIC5maWx0ZXIoKHgpID0+ICF0aGlzLnJlbW90ZUFwcHNDYWNoZS5oYXModG9IYXNoKHgpKSlcbiAgICAuc2xpY2UodGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdCAtIHRoaXMucmVtb3RlQXBwc0NhY2hlLmtleXMoKS5sZW5ndGgpO1xuICBpZiAoIV8uaXNFbXB0eShlbnRyaWVzVG9DbGVhbnVwKSkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNoZWxsKFsncm0nLCAnLWYnLCAuLi5lbnRyaWVzVG9DbGVhbnVwXSk7XG4gICAgICBsb2cuZGVidWcoYERlbGV0ZWQgJHtlbnRyaWVzVG9DbGVhbnVwLmxlbmd0aH0gZXhwaXJlZCBhcHBsaWNhdGlvbiBjYWNoZSBlbnRyaWVzYCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLndhcm4oYENhbm5vdCBkZWxldGUgJHtlbnRyaWVzVG9DbGVhbnVwLmxlbmd0aH0gZXhwaXJlZCBhcHBsaWNhdGlvbiBjYWNoZSBlbnRyaWVzLiBgICtcbiAgICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlbW90ZVBhdGg7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEluc3RhbGxPcHRpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBbNjAwMDBdIC0gVGhlIGNvdW50IG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyBpbnN0YWxsZWQuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdGltZW91dENhcE5hbWUgW2FuZHJvaWRJbnN0YWxsVGltZW91dF0gLSBUaGUgdGltZW91dCBvcHRpb24gbmFtZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnMgY2FuIGluY3JlYXNlIHRoZSB0aW1lb3V0LlxuICogQHByb3BlcnR5IHtib29sZWFufSBhbGxvd1Rlc3RQYWNrYWdlcyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gYWxsb3cgdGVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFja2FnZXMgaW5zdGFsbGF0aW9uLlxuICogQHByb3BlcnR5IHtib29sZWFufSB1c2VTZGNhcmQgW2ZhbHNlXSAtIFNldCB0byB0cnVlIHRvIGluc3RhbGwgdGhlIGFwcCBvbiBzZGNhcmRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0ZWFkIG9mIHRoZSBkZXZpY2UgbWVtb3J5LlxuICogQHByb3BlcnR5IHtib29sZWFufSBncmFudFBlcm1pc3Npb25zIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBncmFudCBhbGwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zIHJlcXVlc3RlZCBpbiB0aGUgYXBwbGljYXRpb24ncyBtYW5pZmVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvbWF0aWNhbGx5IGFmdGVyIHRoZSBpbnN0YWxsYXRpb24gaXMgY29tcGxldGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVyIEFuZHJvaWQgNisuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHJlcGxhY2UgW3RydWVdIC0gU2V0IGl0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGFwcGxpY2F0aW9uIHRvIGJlIHVwZ3JhZGVkL3JlaW5zdGFsbGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXQgaXMgYWxyZWFkeSBwcmVzZW50IG9uIHRoZSBkZXZpY2UuXG4gKi9cblxuLyoqXG4gKiBJbnN0YWxsIHRoZSBwYWNrYWdlIGZyb20gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gVGhlIGZ1bGwgcGF0aCB0byB0aGUgbG9jYWwgcGFja2FnZS5cbiAqIEBwYXJhbSB7P0luc3RhbGxPcHRpb25zfSBvcHRpb25zIC0gVGhlIHNldCBvZiBpbnN0YWxsYXRpb24gb3B0aW9ucy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBhbiB1bmV4cGVjdGVkIGVycm9yIGhhcHBlbnMgZHVyaW5nIGluc3RhbGwuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5pbnN0YWxsID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbCAoYXBwUGF0aCwgb3B0aW9ucyA9IHt9KSB7XG4gIGlmIChhcHBQYXRoLmVuZHNXaXRoKEFQS1NfRVhURU5TSU9OKSkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmluc3RhbGxBcGtzKGFwcFBhdGgsIG9wdGlvbnMpO1xuICB9XG5cbiAgb3B0aW9ucyA9IF8uY2xvbmVEZWVwKG9wdGlvbnMpO1xuICBfLmRlZmF1bHRzKG9wdGlvbnMsIHtcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHRpbWVvdXQ6IHRoaXMuYWRiRXhlY1RpbWVvdXQgPT09IERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCA/IEFQS19JTlNUQUxMX1RJTUVPVVQgOiB0aGlzLmFkYkV4ZWNUaW1lb3V0LFxuICAgIHRpbWVvdXRDYXBOYW1lOiAnYW5kcm9pZEluc3RhbGxUaW1lb3V0JyxcbiAgfSk7XG5cbiAgY29uc3QgaW5zdGFsbEFyZ3MgPSBidWlsZEluc3RhbGxBcmdzKGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKSwgb3B0aW9ucyk7XG4gIGNvbnN0IGluc3RhbGxPcHRzID0ge1xuICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCxcbiAgICB0aW1lb3V0Q2FwTmFtZTogb3B0aW9ucy50aW1lb3V0Q2FwTmFtZSxcbiAgfTtcbiAgbGV0IHBlcmZvcm1BcHBJbnN0YWxsID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5hZGJFeGVjKFtcbiAgICAnaW5zdGFsbCcsXG4gICAgLi4uaW5zdGFsbEFyZ3MsXG4gICAgYXBwUGF0aFxuICBdLCBpbnN0YWxsT3B0cyk7XG4gIC8vIHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQgPD0gMCBtZWFucyBubyBjYWNoaW5nIHNob3VsZCBiZSBhcHBsaWVkXG4gIGlmICh0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0ID4gMCkge1xuICAgIGNvbnN0IGNhY2hlZFJlbW90ZVBhdGggPSBhd2FpdCB0aGlzLmNhY2hlQXBrKGFwcFBhdGgsIHtcbiAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCxcbiAgICB9KTtcbiAgICBwZXJmb3JtQXBwSW5zdGFsbCA9IGFzeW5jICgpID0+IGF3YWl0IHRoaXMuc2hlbGwoW1xuICAgICAgJ3BtJyxcbiAgICAgICdpbnN0YWxsJyxcbiAgICAgIC4uLmluc3RhbGxBcmdzLFxuICAgICAgY2FjaGVkUmVtb3RlUGF0aFxuICAgIF0sIGluc3RhbGxPcHRzKTtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHN0YXJ0ZWQgPSBwcm9jZXNzLmhydGltZSgpO1xuICAgIGNvbnN0IG91dHB1dCA9IGF3YWl0IHBlcmZvcm1BcHBJbnN0YWxsKCk7XG4gICAgY29uc3QgW3NlY29uZHMsIG5hbm9zXSA9IHByb2Nlc3MuaHJ0aW1lKHN0YXJ0ZWQpO1xuICAgIGxvZy5pbmZvKGBUaGUgaW5zdGFsbGF0aW9uIG9mICcke3BhdGguYmFzZW5hbWUoYXBwUGF0aCl9JyB0b29rICR7KHNlY29uZHMgKyBuYW5vcyAvIDFlOSkudG9GaXhlZCgzKX1zYCk7XG4gICAgY29uc3QgdHJ1bmNhdGVkT3V0cHV0ID0gKCFfLmlzU3RyaW5nKG91dHB1dCkgfHwgb3V0cHV0Lmxlbmd0aCA8PSAzMDApID9cbiAgICAgIG91dHB1dCA6IGAke291dHB1dC5zdWJzdHIoMCwgMTUwKX0uLi4ke291dHB1dC5zdWJzdHIob3V0cHV0Lmxlbmd0aCAtIDE1MCl9YDtcbiAgICBsb2cuZGVidWcoYEluc3RhbGwgY29tbWFuZCBzdGRvdXQ6ICR7dHJ1bmNhdGVkT3V0cHV0fWApO1xuICAgIGlmICgvXFxbSU5TVEFMTFtBLVpfXStGQUlMRURbQS1aX10rXFxdLy50ZXN0KG91dHB1dCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihvdXRwdXQpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gb24gc29tZSBzeXN0ZW1zIHRoaXMgd2lsbCB0aHJvdyBhbiBlcnJvciBpZiB0aGUgYXBwIGFscmVhZHlcbiAgICAvLyBleGlzdHNcbiAgICBpZiAoIWVyci5tZXNzYWdlLmluY2x1ZGVzKCdJTlNUQUxMX0ZBSUxFRF9BTFJFQURZX0VYSVNUUycpKSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgQXBwbGljYXRpb24gJyR7YXBwUGF0aH0nIGFscmVhZHkgaW5zdGFsbGVkLiBDb250aW51aW5nLmApO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY3VycmVudCBpbnN0YWxsYXRpb24gc3RhdGUgb2YgdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb25cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIEZ1bGwgcGF0aCB0byB0aGUgYXBwbGljYXRpb25cbiAqIEBwYXJhbSB7P3N0cmluZ30gcGtnIC0gUGFja2FnZSBpZGVudGlmaWVyLiBJZiBvbWl0dGVkIHRoZW4gdGhlIHNjcmlwdCB3aWxsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB0byBleHRyYWN0IGl0IG9uIGl0cyBvd25cbiAqIEByZXR1cm5zIHtzdHJpbmd9XU9uZSBvZiBgQVBQX0lOU1RBTExfU1RBVEVgIGNvbnN0YW50c1xuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUgPSBhc3luYyBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkluc3RhbGxTdGF0ZSAoYXBwUGF0aCwgcGtnID0gbnVsbCkge1xuICBsZXQgYXBrSW5mbyA9IG51bGw7XG4gIGlmICghcGtnKSB7XG4gICAgYXBrSW5mbyA9IGF3YWl0IHRoaXMuZ2V0QXBrSW5mbyhhcHBQYXRoKTtcbiAgICBwa2cgPSBhcGtJbmZvLm5hbWU7XG4gIH1cbiAgaWYgKCFwa2cpIHtcbiAgICBsb2cud2FybihgQ2Fubm90IHJlYWQgdGhlIHBhY2thZ2UgbmFtZSBvZiAnJHthcHBQYXRofSdgKTtcbiAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5VTktOT1dOO1xuICB9XG5cbiAgaWYgKCFhd2FpdCB0aGlzLmlzQXBwSW5zdGFsbGVkKHBrZykpIHtcbiAgICBsb2cuZGVidWcoYEFwcCAnJHthcHBQYXRofScgaXMgbm90IGluc3RhbGxlZGApO1xuICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5PVF9JTlNUQUxMRUQ7XG4gIH1cblxuICBjb25zdCB7dmVyc2lvbkNvZGU6IHBrZ1ZlcnNpb25Db2RlLCB2ZXJzaW9uTmFtZTogcGtnVmVyc2lvbk5hbWVTdHJ9ID0gYXdhaXQgdGhpcy5nZXRQYWNrYWdlSW5mbyhwa2cpO1xuICBjb25zdCBwa2dWZXJzaW9uTmFtZSA9IHNlbXZlci52YWxpZChzZW12ZXIuY29lcmNlKHBrZ1ZlcnNpb25OYW1lU3RyKSk7XG4gIGlmICghYXBrSW5mbykge1xuICAgIGFwa0luZm8gPSBhd2FpdCB0aGlzLmdldEFwa0luZm8oYXBwUGF0aCk7XG4gIH1cbiAgY29uc3Qge3ZlcnNpb25Db2RlOiBhcGtWZXJzaW9uQ29kZSwgdmVyc2lvbk5hbWU6IGFwa1ZlcnNpb25OYW1lU3RyfSA9IGFwa0luZm87XG4gIGNvbnN0IGFwa1ZlcnNpb25OYW1lID0gc2VtdmVyLnZhbGlkKHNlbXZlci5jb2VyY2UoYXBrVmVyc2lvbk5hbWVTdHIpKTtcblxuICBpZiAoIV8uaXNJbnRlZ2VyKGFwa1ZlcnNpb25Db2RlKSB8fCAhXy5pc0ludGVnZXIocGtnVmVyc2lvbkNvZGUpKSB7XG4gICAgbG9nLndhcm4oYENhbm5vdCByZWFkIHZlcnNpb24gY29kZXMgb2YgJyR7YXBwUGF0aH0nIGFuZC9vciAnJHtwa2d9J2ApO1xuICAgIGlmICghXy5pc1N0cmluZyhhcGtWZXJzaW9uTmFtZSkgfHwgIV8uaXNTdHJpbmcocGtnVmVyc2lvbk5hbWUpKSB7XG4gICAgICBsb2cud2FybihgQ2Fubm90IHJlYWQgdmVyc2lvbiBuYW1lcyBvZiAnJHthcHBQYXRofScgYW5kL29yICcke3BrZ30nYCk7XG4gICAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5VTktOT1dOO1xuICAgIH1cbiAgfVxuICBpZiAoXy5pc0ludGVnZXIoYXBrVmVyc2lvbkNvZGUpICYmIF8uaXNJbnRlZ2VyKHBrZ1ZlcnNpb25Db2RlKSkge1xuICAgIGlmIChwa2dWZXJzaW9uQ29kZSA+IGFwa1ZlcnNpb25Db2RlKSB7XG4gICAgICBsb2cuZGVidWcoYFRoZSB2ZXJzaW9uIGNvZGUgb2YgdGhlIGluc3RhbGxlZCAnJHtwa2d9JyBpcyBncmVhdGVyIHRoYW4gdGhlIGFwcGxpY2F0aW9uIHZlcnNpb24gY29kZSAoJHtwa2dWZXJzaW9uQ29kZX0gPiAke2Fwa1ZlcnNpb25Db2RlfSlgKTtcbiAgICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEO1xuICAgIH1cbiAgICAvLyBWZXJzaW9uIGNvZGVzIG1pZ2h0IG5vdCBiZSBtYWludGFpbmVkLiBDaGVjayB2ZXJzaW9uIG5hbWVzLlxuICAgIGlmIChwa2dWZXJzaW9uQ29kZSA9PT0gYXBrVmVyc2lvbkNvZGUpIHtcbiAgICAgIGlmIChfLmlzU3RyaW5nKGFwa1ZlcnNpb25OYW1lKSAmJiBfLmlzU3RyaW5nKHBrZ1ZlcnNpb25OYW1lKSAmJiBzZW12ZXIuc2F0aXNmaWVzKHBrZ1ZlcnNpb25OYW1lLCBgPj0ke2Fwa1ZlcnNpb25OYW1lfWApKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgVGhlIHZlcnNpb24gbmFtZSBvZiB0aGUgaW5zdGFsbGVkICcke3BrZ30nIGlzIGdyZWF0ZXIgb3IgZXF1YWwgdG8gdGhlIGFwcGxpY2F0aW9uIHZlcnNpb24gbmFtZSAoJyR7cGtnVmVyc2lvbk5hbWV9JyA+PSAnJHthcGtWZXJzaW9uTmFtZX0nKWApO1xuICAgICAgICByZXR1cm4gc2VtdmVyLnNhdGlzZmllcyhwa2dWZXJzaW9uTmFtZSwgYD4ke2Fwa1ZlcnNpb25OYW1lfWApXG4gICAgICAgICAgPyB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEXG4gICAgICAgICAgOiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ7XG4gICAgICB9XG4gICAgICBpZiAoIV8uaXNTdHJpbmcoYXBrVmVyc2lvbk5hbWUpIHx8ICFfLmlzU3RyaW5nKHBrZ1ZlcnNpb25OYW1lKSkge1xuICAgICAgICBsb2cuZGVidWcoYFRoZSB2ZXJzaW9uIG5hbWUgb2YgdGhlIGluc3RhbGxlZCAnJHtwa2d9JyBpcyBlcXVhbCB0byBhcHBsaWNhdGlvbiB2ZXJzaW9uIG5hbWUgKCR7cGtnVmVyc2lvbkNvZGV9ID09PSAke2Fwa1ZlcnNpb25Db2RlfSlgKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuU0FNRV9WRVJTSU9OX0lOU1RBTExFRDtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhhcGtWZXJzaW9uTmFtZSkgJiYgXy5pc1N0cmluZyhwa2dWZXJzaW9uTmFtZSkgJiYgc2VtdmVyLnNhdGlzZmllcyhwa2dWZXJzaW9uTmFtZSwgYD49JHthcGtWZXJzaW9uTmFtZX1gKSkge1xuICAgIGxvZy5kZWJ1ZyhgVGhlIHZlcnNpb24gbmFtZSBvZiB0aGUgaW5zdGFsbGVkICcke3BrZ30nIGlzIGdyZWF0ZXIgb3IgZXF1YWwgdG8gdGhlIGFwcGxpY2F0aW9uIHZlcnNpb24gbmFtZSAoJyR7cGtnVmVyc2lvbk5hbWV9JyA+PSAnJHthcGtWZXJzaW9uTmFtZX0nKWApO1xuICAgIHJldHVybiBzZW12ZXIuc2F0aXNmaWVzKHBrZ1ZlcnNpb25OYW1lLCBgPiR7YXBrVmVyc2lvbk5hbWV9YClcbiAgICAgID8gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5ORVdFUl9WRVJTSU9OX0lOU1RBTExFRFxuICAgICAgOiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ7XG4gIH1cblxuICBsb2cuZGVidWcoYFRoZSBpbnN0YWxsZWQgJyR7cGtnfScgcGFja2FnZSBpcyBvbGRlciB0aGFuICcke2FwcFBhdGh9JyAoJHtwa2dWZXJzaW9uQ29kZX0gPCAke2Fwa1ZlcnNpb25Db2RlfSBvciAnJHtwa2dWZXJzaW9uTmFtZX0nIDwgJyR7YXBrVmVyc2lvbk5hbWV9JyknYCk7XG4gIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk9MREVSX1ZFUlNJT05fSU5TVEFMTEVEO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBJbnN0YWxsT3JVcGdyYWRlT3B0aW9uc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IHRpbWVvdXQgWzYwMDAwXSAtIFRoZSBjb3VudCBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAgaXMgaW5zdGFsbGVkLlxuICogQHByb3BlcnR5IHtib29sZWFufSBhbGxvd1Rlc3RQYWNrYWdlcyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gYWxsb3cgdGVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFja2FnZXMgaW5zdGFsbGF0aW9uLlxuICogQHByb3BlcnR5IHtib29sZWFufSB1c2VTZGNhcmQgW2ZhbHNlXSAtIFNldCB0byB0cnVlIHRvIGluc3RhbGwgdGhlIGFwcCBvbiBTRENhcmRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0ZWFkIG9mIHRoZSBkZXZpY2UgbWVtb3J5LlxuICogQHByb3BlcnR5IHtib29sZWFufSBncmFudFBlcm1pc3Npb25zIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBncmFudCBhbGwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zIHJlcXVlc3RlZCBpbiB0aGUgYXBwbGljYXRpb24ncyBtYW5pZmVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvbWF0aWNhbGx5IGFmdGVyIHRoZSBpbnN0YWxsYXRpb24gaXMgY29tcGxldGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVyIEFuZHJvaWQgNisuXG4gKi9cblxuLyoqXG4gKiBJbnN0YWxsIHRoZSBwYWNrYWdlIGZyb20gdGhlIGxvY2FsIGZpbGUgc3lzdGVtIG9yIHVwZ3JhZGUgaXQgaWYgYW4gb2xkZXJcbiAqIHZlcnNpb24gb2YgdGhlIHNhbWUgcGFja2FnZSBpcyBhbHJlYWR5IGluc3RhbGxlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gdGhlIGxvY2FsIHBhY2thZ2UuXG4gKiBAcGFyYW0gez9zdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBpbnN0YWxsZWQgcGFja2FnZS4gVGhlIG1ldGhvZCB3aWxsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmZvcm0gZmFzdGVyIGlmIGl0IGlzIHNldC5cbiAqIEBwYXJhbSB7P0luc3RhbGxPclVwZ3JhZGVPcHRpb25zfSBvcHRpb25zIC0gU2V0IG9mIGluc3RhbGwgb3B0aW9ucy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBhbiB1bmV4cGVjdGVkIGVycm9yIGhhcHBlbnMgZHVyaW5nIGluc3RhbGwuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5pbnN0YWxsT3JVcGdyYWRlID0gYXN5bmMgZnVuY3Rpb24gaW5zdGFsbE9yVXBncmFkZSAoYXBwUGF0aCwgcGtnID0gbnVsbCwgb3B0aW9ucyA9IHt9KSB7XG4gIGlmICghcGtnKSB7XG4gICAgY29uc3QgYXBrSW5mbyA9IGF3YWl0IHRoaXMuZ2V0QXBrSW5mbyhhcHBQYXRoKTtcbiAgICBwa2cgPSBhcGtJbmZvLm5hbWU7XG4gIH1cblxuICBjb25zdCBhcHBTdGF0ZSA9IGF3YWl0IHRoaXMuZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUoYXBwUGF0aCwgcGtnKTtcbiAgc3dpdGNoIChhcHBTdGF0ZSkge1xuICAgIGNhc2UgdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5OT1RfSU5TVEFMTEVEOlxuICAgICAgbG9nLmRlYnVnKGBJbnN0YWxsaW5nICcke2FwcFBhdGh9J2ApO1xuICAgICAgYXdhaXQgdGhpcy5pbnN0YWxsKGFwcFBhdGgsIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtyZXBsYWNlOiBmYWxzZX0pKTtcbiAgICAgIHJldHVybjtcbiAgICBjYXNlIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTkVXRVJfVkVSU0lPTl9JTlNUQUxMRUQ6XG4gICAgY2FzZSB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ6XG4gICAgICBsb2cuZGVidWcoYFRoZXJlIGlzIG5vIG5lZWQgdG8gaW5zdGFsbC91cGdyYWRlICcke2FwcFBhdGh9J2ApO1xuICAgICAgcmV0dXJuO1xuICAgIGNhc2UgdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5PTERFUl9WRVJTSU9OX0lOU1RBTExFRDpcbiAgICAgIGxvZy5kZWJ1ZyhgRXhlY3V0aW5nIHVwZ3JhZGUgb2YgJyR7YXBwUGF0aH0nYCk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgbG9nLmRlYnVnKGBUaGUgY3VycmVudCBpbnN0YWxsIHN0YXRlIG9mICcke2FwcFBhdGh9JyBpcyB1bmtub3duLiBJbnN0YWxsaW5nIGFueXdheWApO1xuICAgICAgYnJlYWs7XG4gIH1cblxuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuaW5zdGFsbChhcHBQYXRoLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7cmVwbGFjZTogdHJ1ZX0pKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbG9nLndhcm4oYENhbm5vdCB1cGdyYWRlICcke3BrZ30nIGJlY2F1c2Ugb2YgJyR7ZXJyLm1lc3NhZ2V9Jy4gVHJ5aW5nIGZ1bGwgcmVpbnN0YWxsYCk7XG4gICAgaWYgKCFhd2FpdCB0aGlzLnVuaW5zdGFsbEFwayhwa2cpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke3BrZ30nIHBhY2thZ2UgY2Fubm90IGJlIHVuaW5zdGFsbGVkYCk7XG4gICAgfVxuICAgIGF3YWl0IHRoaXMuaW5zdGFsbChhcHBQYXRoLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7cmVwbGFjZTogZmFsc2V9KSk7XG4gIH1cbn07XG5cbi8qKlxuICogRXh0cmFjdCBzdHJpbmcgcmVzb3VyY2VzIGZyb20gdGhlIGdpdmVuIHBhY2thZ2Ugb24gbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIHRoZSAuYXBrKHMpIHBhY2thZ2UuXG4gKiBAcGFyYW0gez9zdHJpbmd9IGxhbmd1YWdlIC0gVGhlIG5hbWUgb2YgdGhlIGxhbmd1YWdlIHRvIGV4dHJhY3QgdGhlIHJlc291cmNlcyBmb3IuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVGhlIGRlZmF1bHQgbGFuZ3VhZ2UgaXMgdXNlZCBpZiB0aGlzIGVxdWFscyB0byBgbnVsbGAvYHVuZGVmaW5lZGBcbiAqIEBwYXJhbSB7c3RyaW5nfSBvdXQgLSBUaGUgbmFtZSBvZiB0aGUgZGVzdGluYXRpb24gZm9sZGVyIG9uIHRoZSBsb2NhbCBmaWxlIHN5c3RlbSB0b1xuICogICAgICAgICAgICAgICAgICAgICAgIHN0b3JlIHRoZSBleHRyYWN0ZWQgZmlsZSB0by5cbiAqIEByZXR1cm4ge09iamVjdH0gQSBtYXBwaW5nIG9iamVjdCwgd2hlcmUgcHJvcGVydGllcyBhcmU6ICdhcGtTdHJpbmdzJywgY29udGFpbmluZ1xuICogICAgICAgICAgICAgICAgICBwYXJzZWQgcmVzb3VyY2UgZmlsZSByZXByZXNlbnRlZCBhcyBKU09OIG9iamVjdCwgYW5kICdsb2NhbFBhdGgnLFxuICogICAgICAgICAgICAgICAgICBjb250YWluaW5nIHRoZSBwYXRoIHRvIHRoZSBleHRyYWN0ZWQgZmlsZSBvbiB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0uXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5leHRyYWN0U3RyaW5nc0Zyb21BcGsgPSBhc3luYyBmdW5jdGlvbiBleHRyYWN0U3RyaW5nc0Zyb21BcGsgKGFwcFBhdGgsIGxhbmd1YWdlLCBvdXQpIHtcbiAgbG9nLmRlYnVnKGBFeHRyYWN0aW5nIHN0cmluZ3MgZnJvbSBmb3IgbGFuZ3VhZ2U6ICR7bGFuZ3VhZ2UgfHwgJ2RlZmF1bHQnfWApO1xuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICBhcHBQYXRoID0gYXdhaXQgdGhpcy5leHRyYWN0TGFuZ3VhZ2VBcGsoYXBwUGF0aCwgbGFuZ3VhZ2UpO1xuICB9XG4gIGF3YWl0IHRoaXMuaW5pdEFhcHQoKTtcbiAgbGV0IHJhd0FhcHRPdXRwdXQ7XG4gIHRyeSB7XG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBleGVjKHRoaXMuYmluYXJpZXMuYWFwdCwgW1xuICAgICAgJ2QnLFxuICAgICAgJy0tdmFsdWVzJyxcbiAgICAgICdyZXNvdXJjZXMnLFxuICAgICAgYXBwUGF0aCxcbiAgICBdKTtcbiAgICByYXdBYXB0T3V0cHV0ID0gc3Rkb3V0O1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgZXh0cmFjdCByZXNvdXJjZXMgZnJvbSAnJHthcHBQYXRofScuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgfVxuXG4gIGNvbnN0IGRlZmF1bHRDb25maWdNYXJrZXIgPSAnKGRlZmF1bHQpJztcbiAgbGV0IGNvbmZpZ01hcmtlciA9IGxhbmd1YWdlIHx8IGRlZmF1bHRDb25maWdNYXJrZXI7XG4gIGlmIChjb25maWdNYXJrZXIuaW5jbHVkZXMoJy0nKSAmJiAhY29uZmlnTWFya2VyLmluY2x1ZGVzKCctcicpKSB7XG4gICAgY29uZmlnTWFya2VyID0gY29uZmlnTWFya2VyLnJlcGxhY2UoJy0nLCAnLXInKTtcbiAgfVxuICBpZiAoY29uZmlnTWFya2VyLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnZW4nKSkge1xuICAgIC8vIEFzc3VtZSB0aGUgJ2VuJyBjb25maWd1cmF0aW9uIGlzIHRoZSBkZWZhdWx0IG9uZVxuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQsIFtcbiAgICAgICdkJyxcbiAgICAgICdjb25maWd1cmF0aW9ucycsXG4gICAgICBhcHBQYXRoLFxuICAgIF0pO1xuICAgIGNvbnN0IGNvbmZpZ3MgPSBzdGRvdXQuc3BsaXQob3MuRU9MKTtcbiAgICBpZiAoIWNvbmZpZ3MuaW5jbHVkZXMoY29uZmlnTWFya2VyKSkge1xuICAgICAgbG9nLmRlYnVnKGBUaGVyZSBpcyBubyAnJHtjb25maWdNYXJrZXJ9JyBjb25maWd1cmF0aW9uLiBgICtcbiAgICAgICAgICAgICAgICBgUmVwbGFjaW5nIGl0IHdpdGggJyR7ZGVmYXVsdENvbmZpZ01hcmtlcn0nYCk7XG4gICAgICBjb25maWdNYXJrZXIgPSBkZWZhdWx0Q29uZmlnTWFya2VyO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGFwa1N0cmluZ3MgPSB7fTtcbiAgbGV0IGlzSW5Db25maWcgPSBmYWxzZTtcbiAgbGV0IGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcbiAgbGV0IGlzSW5QbHVyYWxHcm91cCA9IGZhbHNlO1xuICBjb25zdCBzdGFydHNXaXRoQW55ID0gKHMsIGFycikgPT4gYXJyLnJlZHVjZSgoYWNjLCB4KSA9PiBhY2MgfHwgcy5zdGFydHNXaXRoKHgpLCBmYWxzZSk7XG4gIGNvbnN0IG5vcm1hbGl6ZVN0cmluZ01hdGNoID0gKHMpID0+IHMucmVwbGFjZSgvXCIkLywgJycpLnJlcGxhY2UoL15cIi8sICcnKS5yZXBsYWNlKC9cXFxcXCIvZywgJ1wiJyk7XG4gIGZvciAoY29uc3QgbGluZSBvZiByYXdBYXB0T3V0cHV0LnNwbGl0KG9zLkVPTCkpIHtcbiAgICBjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xuICAgIGlmIChfLmlzRW1wdHkodHJpbW1lZExpbmUpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoc3RhcnRzV2l0aEFueSh0cmltbWVkTGluZSwgWydjb25maWcnLCAndHlwZScsICdzcGVjJywgJ1BhY2thZ2UnXSkpIHtcbiAgICAgIGlzSW5Db25maWcgPSB0cmltbWVkTGluZS5zdGFydHNXaXRoKGBjb25maWcgJHtjb25maWdNYXJrZXJ9OmApO1xuICAgICAgY3VycmVudFJlc291cmNlSWQgPSBudWxsO1xuICAgICAgaXNJblBsdXJhbEdyb3VwID0gZmFsc2U7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoIWlzSW5Db25maWcpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmICh0cmltbWVkTGluZS5zdGFydHNXaXRoKCdyZXNvdXJjZScpKSB7XG4gICAgICBpc0luUGx1cmFsR3JvdXAgPSBmYWxzZTtcbiAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcblxuICAgICAgaWYgKHRyaW1tZWRMaW5lLmluY2x1ZGVzKCc6c3RyaW5nLycpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gLzpzdHJpbmdcXC8oXFxTKyk6Ly5leGVjKHRyaW1tZWRMaW5lKTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgY3VycmVudFJlc291cmNlSWQgPSBtYXRjaFsxXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0cmltbWVkTGluZS5pbmNsdWRlcygnOnBsdXJhbHMvJykpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSAvOnBsdXJhbHNcXC8oXFxTKyk6Ly5leGVjKHRyaW1tZWRMaW5lKTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgY3VycmVudFJlc291cmNlSWQgPSBtYXRjaFsxXTtcbiAgICAgICAgICBpc0luUGx1cmFsR3JvdXAgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFJlc291cmNlSWQgJiYgdHJpbW1lZExpbmUuc3RhcnRzV2l0aCgnKHN0cmluZycpKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IC9cIlteXCJcXFxcXSooPzpcXFxcLlteXCJcXFxcXSopKlwiLy5leGVjKHRyaW1tZWRMaW5lKTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBhcGtTdHJpbmdzW2N1cnJlbnRSZXNvdXJjZUlkXSA9IG5vcm1hbGl6ZVN0cmluZ01hdGNoKG1hdGNoWzBdKTtcbiAgICAgIH1cbiAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50UmVzb3VyY2VJZCAmJiBpc0luUGx1cmFsR3JvdXAgJiYgdHJpbW1lZExpbmUuaW5jbHVkZXMoJzogKHN0cmluZycpKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IC9cIlteXCJcXFxcXSooPzpcXFxcLlteXCJcXFxcXSopKlwiLy5leGVjKHRyaW1tZWRMaW5lKTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBhcGtTdHJpbmdzW2N1cnJlbnRSZXNvdXJjZUlkXSA9IFtcbiAgICAgICAgICAuLi4oYXBrU3RyaW5nc1tjdXJyZW50UmVzb3VyY2VJZF0gfHwgW10pLFxuICAgICAgICAgIG5vcm1hbGl6ZVN0cmluZ01hdGNoKG1hdGNoWzBdKSxcbiAgICAgICAgXTtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChfLmlzRW1wdHkoYXBrU3RyaW5ncykpIHtcbiAgICBsb2cud2FybihgTm8gc3RyaW5ncyBoYXZlIGJlZW4gZm91bmQgaW4gJyR7YXBwUGF0aH0nIHJlc291cmNlcyBgICtcbiAgICAgICAgICAgICBgZm9yICcke2NvbmZpZ01hcmtlcn0nIGNvbmZpZ3VyYXRpb25gKTtcbiAgfSBlbHNlIHtcbiAgICBsb2cuaW5mbyhgU3VjY2Vzc2Z1bGx5IGV4dHJhY3RlZCAke18ua2V5cyhhcGtTdHJpbmdzKS5sZW5ndGh9IHN0cmluZ3MgZnJvbSAnJHthcHBQYXRofScgcmVzb3VyY2VzIGAgK1xuICAgICAgICAgICAgIGBmb3IgJyR7Y29uZmlnTWFya2VyfScgY29uZmlndXJhdGlvbmApO1xuICB9XG5cbiAgY29uc3QgbG9jYWxQYXRoID0gcGF0aC5yZXNvbHZlKG91dCwgJ3N0cmluZ3MuanNvbicpO1xuICBhd2FpdCBta2RpcnAob3V0KTtcbiAgYXdhaXQgZnMud3JpdGVGaWxlKGxvY2FsUGF0aCwgSlNPTi5zdHJpbmdpZnkoYXBrU3RyaW5ncywgbnVsbCwgMiksICd1dGYtOCcpO1xuICByZXR1cm4ge2Fwa1N0cmluZ3MsIGxvY2FsUGF0aH07XG59O1xuXG4vKipcbiAqIEdldCB0aGUgbGFuZ3VhZ2UgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgbmFtZSBvZiBkZXZpY2UgbGFuZ3VhZ2UuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXREZXZpY2VMYW5ndWFnZSA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZUxhbmd1YWdlICgpIHtcbiAgbGV0IGxhbmd1YWdlO1xuICBpZiAoYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpIDwgMjMpIHtcbiAgICBsYW5ndWFnZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlU3lzTGFuZ3VhZ2UoKTtcbiAgICBpZiAoIWxhbmd1YWdlKSB7XG4gICAgICBsYW5ndWFnZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlUHJvZHVjdExhbmd1YWdlKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxhbmd1YWdlID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlTG9jYWxlKCkpLnNwbGl0KCctJylbMF07XG4gIH1cbiAgcmV0dXJuIGxhbmd1YWdlO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIGNvdW50cnkgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgbmFtZSBvZiBkZXZpY2UgY291bnRyeS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldERldmljZUNvdW50cnkgPSBhc3luYyBmdW5jdGlvbiBnZXREZXZpY2VDb3VudHJ5ICgpIHtcbiAgLy8gdGhpcyBtZXRob2QgaXMgb25seSB1c2VkIGluIEFQSSA8IDIzXG4gIGxldCBjb3VudHJ5ID0gYXdhaXQgdGhpcy5nZXREZXZpY2VTeXNDb3VudHJ5KCk7XG4gIGlmICghY291bnRyeSkge1xuICAgIGNvdW50cnkgPSBhd2FpdCB0aGlzLmdldERldmljZVByb2R1Y3RDb3VudHJ5KCk7XG4gIH1cbiAgcmV0dXJuIGNvdW50cnk7XG59O1xuXG4vKipcbiAqIEdldCB0aGUgbG9jYWxlIG5hbWUgb2YgdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIG5hbWUgb2YgZGV2aWNlIGxvY2FsZS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldERldmljZUxvY2FsZSA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZUxvY2FsZSAoKSB7XG4gIC8vIHRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBpbiBBUEkgPj0gMjNcbiAgbGV0IGxvY2FsZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlU3lzTG9jYWxlKCk7XG4gIGlmICghbG9jYWxlKSB7XG4gICAgbG9jYWxlID0gYXdhaXQgdGhpcy5nZXREZXZpY2VQcm9kdWN0TG9jYWxlKCk7XG4gIH1cbiAgcmV0dXJuIGxvY2FsZTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBsb2NhbGUgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QgYW5kIHRoZSBmb3JtYXQgb2YgdGhlIGxvY2FsZSBpcyBlbi1VUywgZm9yIGV4YW1wbGUuXG4gKiBUaGlzIG1ldGhvZCBjYWxsIHNldERldmljZUxhbmd1YWdlQ291bnRyeSwgc28sIHBsZWFzZSB1c2Ugc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5IGFzIHBvc3NpYmxlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBsb2NhbGUgLSBOYW1lcyBvZiB0aGUgZGV2aWNlIGxhbmd1YWdlIGFuZCB0aGUgY291bnRyeSBjb25uZWN0ZWQgd2l0aCBgLWAuIGUuZy4gZW4tVVMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5zZXREZXZpY2VMb2NhbGUgPSBhc3luYyBmdW5jdGlvbiBzZXREZXZpY2VMb2NhbGUgKGxvY2FsZSkge1xuICBjb25zdCB2YWxpZGF0ZUxvY2FsZSA9IG5ldyBSZWdFeHAoL1thLXpBLVpdKy1bYS16QS1aMC05XSsvKTtcbiAgaWYgKCF2YWxpZGF0ZUxvY2FsZS50ZXN0KGxvY2FsZSkpIHtcbiAgICBsb2cud2Fybihgc2V0RGV2aWNlTG9jYWxlIHJlcXVpcmVzIHRoZSBmb2xsb3dpbmcgZm9ybWF0OiBlbi1VUyBvciBqYS1KUGApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGxldCBzcGxpdF9sb2NhbGUgPSBsb2NhbGUuc3BsaXQoJy0nKTtcbiAgYXdhaXQgdGhpcy5zZXREZXZpY2VMYW5ndWFnZUNvdW50cnkoc3BsaXRfbG9jYWxlWzBdLCBzcGxpdF9sb2NhbGVbMV0pO1xufTtcblxuLyoqXG4gKiBNYWtlIHN1cmUgY3VycmVudCBkZXZpY2UgbG9jYWxlIGlzIGV4cGVjdGVkIG9yIG5vdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgLSBMYW5ndWFnZS4gVGhlIGxhbmd1YWdlIGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUsIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gbG93ZXIgY2FzZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBjb3VudHJ5IC0gQ291bnRyeS4gVGhlIGxhbmd1YWdlIGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUsIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gbG93ZXIgY2FzZS5cbiAqIEBwYXJhbSB7P3N0cmluZ30gc2NyaXB0IC0gU2NyaXB0LiBUaGUgc2NyaXB0IGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUgYnV0IExvY2FsZSBhbHdheXMgY2Fub25pY2FsaXplcyB0byB0aXRsZSBjYXNlLlxuICpcbiAqIEByZXR1cm4ge2Jvb2xlYW59IElmIGN1cnJlbnQgbG9jYWxlIGlzIGxhbmd1YWdlIGFuZCBjb3VudHJ5IGFzIGFyZ3VtZW50cywgcmV0dXJuIHRydWUuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5lbnN1cmVDdXJyZW50TG9jYWxlID0gYXN5bmMgZnVuY3Rpb24gZW5zdXJlQ3VycmVudExvY2FsZSAobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCA9IG51bGwpIHtcbiAgY29uc3QgaGFzTGFuZ3VhZ2UgPSBfLmlzU3RyaW5nKGxhbmd1YWdlKTtcbiAgY29uc3QgaGFzQ291bnRyeSA9IF8uaXNTdHJpbmcoY291bnRyeSk7XG5cbiAgaWYgKCFoYXNMYW5ndWFnZSAmJiAhaGFzQ291bnRyeSkge1xuICAgIGxvZy53YXJuKCdlbnN1cmVDdXJyZW50TG9jYWxlIHJlcXVpcmVzIGxhbmd1YWdlIG9yIGNvdW50cnknKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBnZXQgbG93ZXIgY2FzZSB2ZXJzaW9ucyBvZiB0aGUgc3RyaW5nc1xuICBsYW5ndWFnZSA9IChsYW5ndWFnZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgY291bnRyeSA9IChjb3VudHJ5IHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuXG4gIGNvbnN0IGFwaUxldmVsID0gYXdhaXQgdGhpcy5nZXRBcGlMZXZlbCgpO1xuXG4gIHJldHVybiBhd2FpdCByZXRyeUludGVydmFsKDUsIDEwMDAsIGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKGFwaUxldmVsIDwgMjMpIHtcbiAgICAgICAgbGV0IGN1ckxhbmd1YWdlLCBjdXJDb3VudHJ5O1xuICAgICAgICBpZiAoaGFzTGFuZ3VhZ2UpIHtcbiAgICAgICAgICBjdXJMYW5ndWFnZSA9IChhd2FpdCB0aGlzLmdldERldmljZUxhbmd1YWdlKCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKCFoYXNDb3VudHJ5ICYmIGxhbmd1YWdlID09PSBjdXJMYW5ndWFnZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChoYXNDb3VudHJ5KSB7XG4gICAgICAgICAgY3VyQ291bnRyeSA9IChhd2FpdCB0aGlzLmdldERldmljZUNvdW50cnkoKSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBpZiAoIWhhc0xhbmd1YWdlICYmIGNvdW50cnkgPT09IGN1ckNvdW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobGFuZ3VhZ2UgPT09IGN1ckxhbmd1YWdlICYmIGNvdW50cnkgPT09IGN1ckNvdW50cnkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgY3VyTG9jYWxlID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlTG9jYWxlKCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vIHpoLWhhbnMtY24gOiB6aC1jblxuICAgICAgICBjb25zdCBsb2NhbGVDb2RlID0gc2NyaXB0ID8gYCR7bGFuZ3VhZ2V9LSR7c2NyaXB0LnRvTG93ZXJDYXNlKCl9LSR7Y291bnRyeX1gIDogYCR7bGFuZ3VhZ2V9LSR7Y291bnRyeX1gO1xuXG4gICAgICAgIGlmIChsb2NhbGVDb2RlID09PSBjdXJMb2NhbGUpIHtcbiAgICAgICAgICBsb2cuZGVidWcoYFJlcXVlc3RlZCBsb2NhbGUgaXMgZXF1YWwgdG8gY3VycmVudCBsb2NhbGU6ICcke2N1ckxvY2FsZX0nYCk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIC8vIGlmIHRoZXJlIGhhcyBiZWVuIGFuIGVycm9yLCByZXN0YXJ0IGFkYiBhbmQgcmV0cnlcbiAgICAgIGxvZy5lcnJvcihgVW5hYmxlIHRvIGNoZWNrIGRldmljZSBsb2NhbGl6YXRpb246ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICBsb2cuZGVidWcoJ1Jlc3RhcnRpbmcgQURCIGFuZCByZXRyeWluZy4uLicpO1xuICAgICAgYXdhaXQgdGhpcy5yZXN0YXJ0QWRiKCk7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBsb2NhbGUgbmFtZSBvZiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlIC0gTGFuZ3VhZ2UuIFRoZSBsYW5ndWFnZSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIGxvd2VyIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezIsOH0uIGUuZy4gZW4sIGphIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICogQHBhcmFtIHtzdHJpbmd9IGNvdW50cnkgLSBDb3VudHJ5LiBUaGUgY291bnRyeSAocmVnaW9uKSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHVwcGVyIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezJ9IHwgWzAtOV17M30uIGUuZy4gVVMsIEpQIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICogQHBhcmFtIHs/c3RyaW5nfSBzY3JpcHQgLSBTY3JpcHQuIFRoZSBzY3JpcHQgZmllbGQgaXMgY2FzZSBpbnNlbnNpdGl2ZSBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIHRpdGxlIGNhc2UuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFthLXpBLVpdezR9LiBlLmcuIEhhbnMgaW4gemgtSGFucy1DTiA6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3JlZmVyZW5jZS9qYXZhL3V0aWwvTG9jYWxlLmh0bWxcbiAqL1xuYXBrVXRpbHNNZXRob2RzLnNldERldmljZUxhbmd1YWdlQ291bnRyeSA9IGFzeW5jIGZ1bmN0aW9uIHNldERldmljZUxhbmd1YWdlQ291bnRyeSAobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCA9IG51bGwpIHtcbiAgbGV0IGhhc0xhbmd1YWdlID0gbGFuZ3VhZ2UgJiYgXy5pc1N0cmluZyhsYW5ndWFnZSk7XG4gIGxldCBoYXNDb3VudHJ5ID0gY291bnRyeSAmJiBfLmlzU3RyaW5nKGNvdW50cnkpO1xuICBpZiAoIWhhc0xhbmd1YWdlIHx8ICFoYXNDb3VudHJ5KSB7XG4gICAgbG9nLndhcm4oYHNldERldmljZUxhbmd1YWdlQ291bnRyeSByZXF1aXJlcyBsYW5ndWFnZSBhbmQgY291bnRyeSBhdCBsZWFzdGApO1xuICAgIGxvZy53YXJuKGBHb3QgbGFuZ3VhZ2U6ICcke2xhbmd1YWdlfScgYW5kIGNvdW50cnk6ICcke2NvdW50cnl9J2ApO1xuICAgIHJldHVybjtcbiAgfVxuICBsZXQgYXBpTGV2ZWwgPSBhd2FpdCB0aGlzLmdldEFwaUxldmVsKCk7XG5cbiAgbGFuZ3VhZ2UgPSAobGFuZ3VhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gIGNvdW50cnkgPSAoY291bnRyeSB8fCAnJykudG9VcHBlckNhc2UoKTtcblxuICBpZiAoYXBpTGV2ZWwgPCAyMykge1xuICAgIGxldCBjdXJMYW5ndWFnZSA9IChhd2FpdCB0aGlzLmdldERldmljZUxhbmd1YWdlKCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IGN1ckNvdW50cnkgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VDb3VudHJ5KCkpLnRvVXBwZXJDYXNlKCk7XG5cbiAgICBpZiAobGFuZ3VhZ2UgIT09IGN1ckxhbmd1YWdlIHx8IGNvdW50cnkgIT09IGN1ckNvdW50cnkpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2V0RGV2aWNlU3lzTG9jYWxlVmlhU2V0dGluZ0FwcChsYW5ndWFnZSwgY291bnRyeSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBjdXJMb2NhbGUgPSBhd2FpdCB0aGlzLmdldERldmljZUxvY2FsZSgpO1xuXG4gICAgLy8gemgtSGFucy1DTiA6IHpoLUNOXG4gICAgY29uc3QgbG9jYWxlQ29kZSA9IHNjcmlwdCA/IGAke2xhbmd1YWdlfS0ke3NjcmlwdH0tJHtjb3VudHJ5fWAgOiBgJHtsYW5ndWFnZX0tJHtjb3VudHJ5fWA7XG4gICAgbG9nLmRlYnVnKGBDdXJyZW50IGxvY2FsZTogJyR7Y3VyTG9jYWxlfSc7IHJlcXVlc3RlZCBsb2NhbGU6ICcke2xvY2FsZUNvZGV9J2ApO1xuICAgIGlmIChsb2NhbGVDb2RlLnRvTG93ZXJDYXNlKCkgIT09IGN1ckxvY2FsZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICBhd2FpdCB0aGlzLnNldERldmljZVN5c0xvY2FsZVZpYVNldHRpbmdBcHAobGFuZ3VhZ2UsIGNvdW50cnksIHNjcmlwdCk7XG4gICAgfVxuICB9XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEFwcEluZm9cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBuYW1lIC0gUGFja2FnZSBuYW1lLCBmb3IgZXhhbXBsZSAnY29tLmFjbWUuYXBwJy5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB2ZXJzaW9uQ29kZSAtIFZlcnNpb24gY29kZS5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB2ZXJzaW9uTmFtZSAtIFZlcnNpb24gbmFtZSwgZm9yIGV4YW1wbGUgJzEuMCcuXG4gKi9cblxuLyoqXG4gKiBHZXQgdGhlIHBhY2thZ2UgaW5mbyBmcm9tIGxvY2FsIGFwayBmaWxlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIC0gVGhlIGZ1bGwgcGF0aCB0byBleGlzdGluZyAuYXBrKHMpIHBhY2thZ2Ugb24gdGhlIGxvY2FsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUgc3lzdGVtLlxuICogQHJldHVybiB7P0FwcEluZm99IFRoZSBwYXJzZWQgYXBwbGljYXRpb24gaW5mb3JtYXRpb24uXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXRBcGtJbmZvID0gYXN5bmMgZnVuY3Rpb24gZ2V0QXBrSW5mbyAoYXBwUGF0aCkge1xuICBpZiAoIWF3YWl0IGZzLmV4aXN0cyhhcHBQYXRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVGhlIGZpbGUgYXQgcGF0aCAke2FwcFBhdGh9IGRvZXMgbm90IGV4aXN0IG9yIGlzIG5vdCBhY2Nlc3NpYmxlYCk7XG4gIH1cblxuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICBhcHBQYXRoID0gYXdhaXQgdGhpcy5leHRyYWN0QmFzZUFwayhhcHBQYXRoKTtcbiAgfVxuXG4gIGF3YWl0IHRoaXMuaW5pdEFhcHQoKTtcbiAgdHJ5IHtcbiAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5iaW5hcmllcy5hYXB0LCBbJ2QnLCAnYmFkZ2luZycsIGFwcFBhdGhdKTtcbiAgICBjb25zdCBtYXRjaGVzID0gbmV3IFJlZ0V4cCgvcGFja2FnZTogbmFtZT0nKFteJ10rKScgdmVyc2lvbkNvZGU9JyhcXGQrKScgdmVyc2lvbk5hbWU9JyhbXiddKyknLykuZXhlYyhzdGRvdXQpO1xuICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBtYXRjaGVzWzFdLFxuICAgICAgICB2ZXJzaW9uQ29kZTogcGFyc2VJbnQobWF0Y2hlc1syXSwgMTApLFxuICAgICAgICB2ZXJzaW9uTmFtZTogbWF0Y2hlc1szXVxuICAgICAgfTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxvZy53YXJuKGBFcnJvciBcIiR7ZXJyLm1lc3NhZ2V9XCIgd2hpbGUgZ2V0dGluZyBiYWRnaW5nIGluZm9gKTtcbiAgfVxuICByZXR1cm4ge307XG59O1xuXG4vKipcbiAqIEdldCB0aGUgcGFja2FnZSBpbmZvIGZyb20gdGhlIGluc3RhbGxlZCBhcHBsaWNhdGlvbi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIGluc3RhbGxlZCBwYWNrYWdlLlxuICogQHJldHVybiB7P0FwcEluZm99IFRoZSBwYXJzZWQgYXBwbGljYXRpb24gaW5mb3JtYXRpb24uXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXRQYWNrYWdlSW5mbyA9IGFzeW5jIGZ1bmN0aW9uIGdldFBhY2thZ2VJbmZvIChwa2cpIHtcbiAgbG9nLmRlYnVnKGBHZXR0aW5nIHBhY2thZ2UgaW5mbyBmb3IgJyR7cGtnfSdgKTtcbiAgbGV0IHJlc3VsdCA9IHtuYW1lOiBwa2d9O1xuICB0cnkge1xuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoWydkdW1wc3lzJywgJ3BhY2thZ2UnLCBwa2ddKTtcbiAgICBjb25zdCB2ZXJzaW9uTmFtZU1hdGNoID0gbmV3IFJlZ0V4cCgvdmVyc2lvbk5hbWU9KFtcXGQrLl0rKS8pLmV4ZWMoc3Rkb3V0KTtcbiAgICBpZiAodmVyc2lvbk5hbWVNYXRjaCkge1xuICAgICAgcmVzdWx0LnZlcnNpb25OYW1lID0gdmVyc2lvbk5hbWVNYXRjaFsxXTtcbiAgICB9XG4gICAgY29uc3QgdmVyc2lvbkNvZGVNYXRjaCA9IG5ldyBSZWdFeHAoL3ZlcnNpb25Db2RlPShcXGQrKS8pLmV4ZWMoc3Rkb3V0KTtcbiAgICBpZiAodmVyc2lvbkNvZGVNYXRjaCkge1xuICAgICAgcmVzdWx0LnZlcnNpb25Db2RlID0gcGFyc2VJbnQodmVyc2lvbkNvZGVNYXRjaFsxXSwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cud2FybihgRXJyb3IgJyR7ZXJyLm1lc3NhZ2V9JyB3aGlsZSBkdW1waW5nIHBhY2thZ2UgaW5mb2ApO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5hcGtVdGlsc01ldGhvZHMucHVsbEFwayA9IGFzeW5jIGZ1bmN0aW9uIHB1bGxBcGsgKHBrZywgdG1wRGlyKSB7XG4gIGNvbnN0IHBrZ1BhdGggPSAoYXdhaXQgdGhpcy5hZGJFeGVjKFsnc2hlbGwnLCAncG0nLCAncGF0aCcsIHBrZ10pKS5yZXBsYWNlKCdwYWNrYWdlOicsICcnKTtcbiAgY29uc3QgdG1wQXBwID0gcGF0aC5yZXNvbHZlKHRtcERpciwgYCR7cGtnfS5hcGtgKTtcbiAgYXdhaXQgdGhpcy5wdWxsKHBrZ1BhdGgsIHRtcEFwcCk7XG4gIGxvZy5kZWJ1ZyhgUHVsbGVkIGFwcCBmb3IgcGFja2FnZSAnJHtwa2d9JyB0byAnJHt0bXBBcHB9J2ApO1xuICByZXR1cm4gdG1wQXBwO1xufTtcblxuZXhwb3J0IHsgUkVNT1RFX0NBQ0hFX1JPT1QgfTtcbmV4cG9ydCBkZWZhdWx0IGFwa1V0aWxzTWV0aG9kcztcbiJdLCJmaWxlIjoibGliL3Rvb2xzL2Fway11dGlscy5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
